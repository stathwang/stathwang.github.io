<!DOCTYPE html>
<html lang="en">
<head>
  <link href='//fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,700,400italic' rel='stylesheet' type='text/css'>

    <link rel="stylesheet" type="text/css" href="https://stathwang.github.io/theme/stylesheet/style.min.css">

  <link rel="stylesheet" type="text/css" href="https://stathwang.github.io/theme/pygments/monokai.min.css">
  <link rel="stylesheet" type="text/css" href="https://stathwang.github.io/theme/font-awesome/css/font-awesome.min.css">


    <link href="https://stathwang.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Seong Hyun Hwang Atom">



  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="robots" content="" />

    <!-- Chrome, Firefox OS and Opera -->
    <meta name="theme-color" content="#333333">
    <!-- Windows Phone -->
    <meta name="msapplication-navbutton-color" content="#333333">
    <!-- iOS Safari -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

<meta name="author" content="Seong Hyun Hwang" />
<meta name="description" content="Wikipedia defines: The zero-inflated Poisson model concerns a random event containing excess zero-count data in unit time. For instance, the number of insurance claims within a population for a certain type of risk would be zero-inflated by those people who have not taken out insurance against the risk and thus …" />
<meta name="keywords" content="zero inflated poisson, mcmc, bayesian statistics, statistics, r">
<meta property="og:site_name" content="Seong Hyun Hwang"/>
<meta property="og:title" content="Bayesian Zero-Inflated Poisson Model"/>
<meta property="og:description" content="Wikipedia defines: The zero-inflated Poisson model concerns a random event containing excess zero-count data in unit time. For instance, the number of insurance claims within a population for a certain type of risk would be zero-inflated by those people who have not taken out insurance against the risk and thus …"/>
<meta property="og:locale" content="en_US"/>
<meta property="og:url" content="https://stathwang.github.io/bayesian-zero-inflated-poisson-model.html"/>
<meta property="og:type" content="article"/>
<meta property="article:published_time" content="2017-07-05 19:30:00-04:00"/>
<meta property="article:modified_time" content=""/>
<meta property="article:author" content="https://stathwang.github.io/author/seong-hyun-hwang.html">
<meta property="article:section" content="Bayesian Statistics"/>
<meta property="article:tag" content="zero inflated poisson"/>
<meta property="article:tag" content="mcmc"/>
<meta property="article:tag" content="bayesian statistics"/>
<meta property="article:tag" content="statistics"/>
<meta property="article:tag" content="r"/>
<meta property="og:image" content="http://www.gravatar.com/avatar/ea0e94239070aef9781e64fb53facf13?s=120&d=http%3A%2F%2Fwww.example.com%2Fdefault.jpg">
  <title>Seong Hyun Hwang &ndash; Bayesian Zero-Inflated Poisson Model</title>
</head>
<body>
  <aside>
    <div>
      <a href="https://stathwang.github.io">
        <img src="http://www.gravatar.com/avatar/ea0e94239070aef9781e64fb53facf13?s=120&d=http%3A%2F%2Fwww.example.com%2Fdefault.jpg" alt="Seong Hyun Hwang" title="Seong Hyun Hwang">
      </a>
      <h1><a href="https://stathwang.github.io">Seong Hyun Hwang</a></h1>
<p>Data Scientist - Product Developer</p>      <nav>
        <ul class="list">
          <li><a href="https://stathwang.github.io/pages/about.html#about">about</a></li>
          <li><a href="https://stathwang.github.io/pages/photos.html#photos">photos</a></li>
          <li><a href="https://stathwang.github.io/pages/projects.html#projects">projects</a></li>
        </ul>
      </nav>
      <ul class="social">
        <li><a class="sc-github" href="https://github.com/stathwang" target="_blank"><i class="fa fa-github"></i></a></li>
        <li><a class="sc-google" href="https://plus.google.com/112356517445062778569" target="_blank"><i class="fa fa-google"></i></a></li>
        <li><a class="sc-twitter" href="https://twitter.com/superhugehwang" target="_blank"><i class="fa fa-twitter"></i></a></li>
        <li><a class="sc-rss" href="//stathwang.github.io/feeds/all.atom.xml" target="_blank"><i class="fa fa-rss"></i></a></li>
      </ul>
    </div>
  </aside>
  <main>
    <nav>
      <a href="https://stathwang.github.io">Home</a>
      <a href="/archives.html">Archives</a>
      <a href="/categories.html">Categories</a>
      <a href="/tags.html">Tags</a>
      <a href="https://stathwang.github.io/feeds/all.atom.xml">Atom</a>
    </nav>

<article>
  <header>
    <h1 id="bayesian-zero-inflated-poisson-model">Bayesian Zero-Inflated Poisson Model</h1>
    <p>Posted on July 05 2017 in <a href="https://stathwang.github.io/category/bayesian-statistics.html">Bayesian Statistics</a></p>
  </header>
  <div>
    <p>Wikipedia defines:</p>
<blockquote>
<p>The zero-inflated Poisson model concerns a random event containing excess zero-count data in unit time. For instance, the number of insurance claims within a population for a certain type of risk would be zero-inflated by those people who have not taken out insurance against the risk and thus are unable to claim.</p>
</blockquote>
<p>Specifically, the model can be broken down into two components that correspond to two different zero generating processes. The first is a binary distribution that generates structural zeroes, and the second process is governed by a Poisson distribution that generates counts, some of which may be zero. </p>
<p>The two model components are aggregated as follows:</p>
<p>Suppose $Y_1,..., Y_n | \theta, \lambda \tilde $</p>
<p>Let's derive the full conditional distributions for <span class="math">\(\theta\)</span> and <span class="math">\(\lambda\)</span> assuming that we observe at least one <span class="math">\(Y_i = 0\)</span> and at least one <span class="math">\(Y_j &gt; 0\)</span>.</p>
<div class="highlight"><pre><span></span><span class="n">obs</span> <span class="o">&lt;-</span> <span class="n">scan</span><span class="p">(</span><span class="s2">&quot;ZIP.txt&quot;</span><span class="p">)</span>
<span class="n">hist</span><span class="p">(</span><span class="n">obs</span><span class="p">,</span> <span class="n">main</span> <span class="o">=</span> <span class="s2">&quot;Histogram of 1000 observations&quot;</span><span class="p">,</span> <span class="n">xlab</span> <span class="o">=</span> <span class="s2">&quot;Observations&quot;</span><span class="p">)</span>
</pre></div>


<p>The dataset contains 1000 observations from the model specified. Generate samples from the posterior distribution of interest using the Markov chain Monte Carlo (MCMC) simulation. I'm going to use three chains with overdispersed initial values with respect to the true marginal posterior distributions for <span class="math">\(\theta\)</span> and <span class="math">\(\lambda\)</span> in each chain.</p>
<div class="highlight"><pre><span></span><span class="nb">set</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">28473</span><span class="p">)</span>

<span class="c1"># function to convert theta to psi</span>
<span class="c1"># theta between 0 and 1</span>
<span class="c1"># psi is real-valued</span>
<span class="n">conv_theta</span> <span class="o">&lt;-</span> <span class="n">function</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span><span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="n">theta</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">theta</span><span class="p">)))</span>
<span class="p">}</span>

<span class="c1"># function to convert psi to theta</span>
<span class="n">conv_psi</span> <span class="o">&lt;-</span> <span class="n">function</span><span class="p">(</span><span class="n">psi</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span><span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="n">psi</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">exp</span><span class="p">(</span><span class="n">psi</span><span class="p">)))</span>
<span class="p">}</span>

<span class="c1"># function to calculate h(theta)</span>
<span class="n">log_theta_h</span> <span class="o">&lt;-</span> <span class="n">function</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="k">lambda</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span><span class="p">(</span><span class="n">nA</span><span class="o">*</span><span class="n">log</span><span class="p">((</span><span class="n">theta</span><span class="o">+</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">theta</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="k">lambda</span><span class="p">)))</span> <span class="o">+</span> <span class="p">(</span><span class="n">a</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">log</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">nB</span><span class="o">+</span><span class="n">b</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">log</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">theta</span><span class="p">))</span>
<span class="p">}</span>

<span class="c1"># function to calculate h(lambda)</span>
<span class="n">log_lambda_h</span> <span class="o">&lt;-</span> <span class="n">function</span><span class="p">(</span><span class="k">lambda</span><span class="p">,</span> <span class="n">theta</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span><span class="p">(</span><span class="n">nA</span><span class="o">*</span><span class="n">log</span><span class="p">((</span><span class="n">theta</span><span class="o">+</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">theta</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="k">lambda</span><span class="p">)))</span> <span class="o">-</span> <span class="n">nB</span><span class="o">*</span><span class="k">lambda</span> <span class="o">-</span> <span class="n">d</span><span class="o">*</span><span class="k">lambda</span> <span class="o">+</span> <span class="p">(</span><span class="n">syB</span><span class="o">+</span><span class="n">c</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">log</span><span class="p">(</span><span class="k">lambda</span><span class="p">))</span>
<span class="p">}</span>

<span class="c1"># set hyperparameters to make priors uninformative</span>
<span class="n">a</span> <span class="o">&lt;-</span> <span class="n">b</span> <span class="o">&lt;-</span> <span class="mi">1</span>
<span class="n">c</span> <span class="o">&lt;-</span> <span class="n">d</span> <span class="o">&lt;-</span> <span class="mf">0.01</span>

<span class="c1"># set data values</span>
<span class="n">nA</span> <span class="o">&lt;-</span> <span class="nb">sum</span><span class="p">(</span><span class="n">obs</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">nB</span> <span class="o">&lt;-</span> <span class="nb">sum</span><span class="p">(</span><span class="n">obs</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">syB</span> <span class="o">&lt;-</span> <span class="nb">sum</span><span class="p">(</span><span class="n">obs</span><span class="p">[</span><span class="n">obs</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">])</span>

<span class="c1"># set mcmc parameters</span>
<span class="n">mcmc_samples</span> <span class="o">&lt;-</span> <span class="mi">20000</span>
<span class="n">chains</span> <span class="o">&lt;-</span> <span class="mi">3</span>
<span class="n">metrop_var</span> <span class="o">&lt;-</span> <span class="mf">0.3</span>
<span class="n">accept_theta</span> <span class="o">&lt;-</span> <span class="n">accept_lambda</span> <span class="o">&lt;-</span> <span class="n">rep</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">times</span> <span class="o">=</span> <span class="n">chains</span><span class="p">)</span>

<span class="c1"># create matrices to store posterior theta and lambda values</span>
<span class="n">theta</span> <span class="o">&lt;-</span> <span class="k">lambda</span> <span class="o">&lt;-</span> <span class="n">matrix</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">nrow</span> <span class="o">=</span> <span class="n">mcmc_samples</span><span class="p">,</span> <span class="n">ncol</span> <span class="o">=</span> <span class="n">chains</span><span class="p">)</span>

<span class="c1"># set overdispersed initial values of theta and lambda</span>
<span class="n">theta</span><span class="p">[</span><span class="mi">1</span><span class="p">,]</span> <span class="o">&lt;-</span> <span class="n">c</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">)</span>
<span class="k">lambda</span><span class="p">[</span><span class="mi">1</span><span class="p">,]</span> <span class="o">&lt;-</span> <span class="n">c</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="ow">in</span> <span class="mi">2</span><span class="p">:</span><span class="n">mcmc_samples</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">theta</span><span class="p">[</span><span class="n">i</span><span class="p">,]</span> <span class="o">&lt;-</span> <span class="n">theta</span><span class="p">[(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">),]</span>
  <span class="k">lambda</span><span class="p">[</span><span class="n">i</span><span class="p">,]</span> <span class="o">&lt;-</span> <span class="k">lambda</span><span class="p">[(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">),]</span>

  <span class="n">theta_proposed</span> <span class="o">&lt;-</span> <span class="n">conv_psi</span><span class="p">(</span><span class="n">rnorm</span><span class="p">(</span><span class="n">n</span> <span class="o">=</span> <span class="n">chains</span><span class="p">,</span> 
                                   <span class="n">mean</span> <span class="o">=</span> <span class="n">conv_theta</span><span class="p">(</span><span class="n">theta</span><span class="p">[(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">),]),</span> 
                                   <span class="n">sd</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">metrop_var</span><span class="p">)))</span>
  <span class="n">ratio_ht</span> <span class="o">&lt;-</span> <span class="n">exp</span><span class="p">(</span><span class="n">log_theta_h</span><span class="p">(</span><span class="n">theta_proposed</span><span class="p">,</span> <span class="k">lambda</span><span class="p">[(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">),])</span> <span class="o">-</span> 
                    <span class="n">log_theta_h</span><span class="p">(</span><span class="n">theta</span><span class="p">[(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">),],</span> <span class="k">lambda</span><span class="p">[(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">),]))</span>
  <span class="k">for</span> <span class="p">(</span><span class="n">j</span> <span class="ow">in</span> <span class="mi">1</span><span class="p">:</span><span class="n">chains</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">ratio_ht</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">runif</span><span class="p">(</span><span class="n">n</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">min</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">max</span> <span class="o">=</span> <span class="mi">1</span><span class="p">))</span> <span class="p">{</span>
      <span class="n">theta</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">&lt;-</span> <span class="n">theta_proposed</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
      <span class="n">accept_theta</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">&lt;-</span> <span class="n">accept_theta</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="c1"># update lambda</span>
  <span class="n">lambda_proposed</span> <span class="o">&lt;-</span> <span class="n">rnorm</span><span class="p">(</span><span class="n">n</span> <span class="o">=</span> <span class="n">chains</span><span class="p">,</span> 
                           <span class="n">mean</span> <span class="o">=</span> <span class="k">lambda</span><span class="p">[(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">),],</span> 
                           <span class="n">sd</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">metrop_var</span><span class="p">))</span>
  <span class="k">for</span> <span class="p">(</span><span class="n">j</span> <span class="ow">in</span> <span class="mi">1</span><span class="p">:</span><span class="n">chains</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">lambda_proposed</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">ratio_lt</span> <span class="o">&lt;-</span> <span class="n">exp</span><span class="p">(</span><span class="n">log_lambda_h</span><span class="p">(</span><span class="n">lambda_proposed</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">theta</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">])</span> <span class="o">-</span> 
                        <span class="n">log_lambda_h</span><span class="p">(</span><span class="k">lambda</span><span class="p">[(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="n">j</span><span class="p">],</span> <span class="n">theta</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]))</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">ratio_lt</span> <span class="o">&gt;=</span> <span class="n">runif</span><span class="p">(</span><span class="n">n</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">min</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">max</span> <span class="o">=</span> <span class="mi">1</span><span class="p">))</span> <span class="p">{</span>
        <span class="k">lambda</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">&lt;-</span> <span class="n">lambda_proposed</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
        <span class="n">accept_lambda</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">&lt;-</span> <span class="n">accept_lambda</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="n">atable</span> <span class="o">&lt;-</span> <span class="n">rbind</span><span class="p">(</span><span class="n">accept_theta</span><span class="o">/</span><span class="n">mcmc_samples</span><span class="p">,</span> <span class="n">accept_lambda</span><span class="o">/</span><span class="n">mcmc_samples</span><span class="p">)</span>
<span class="n">dimnames</span><span class="p">(</span><span class="n">atable</span><span class="p">)</span> <span class="o">&lt;-</span> <span class="nb">list</span><span class="p">(</span><span class="n">c</span><span class="p">(</span><span class="s1">&#39;theta&#39;</span><span class="p">,</span> <span class="s1">&#39;lambda&#39;</span><span class="p">),</span> <span class="n">c</span><span class="p">(</span><span class="s1">&#39;chain 1&#39;</span><span class="p">,</span> <span class="s1">&#39;chain 2&#39;</span><span class="p">,</span> <span class="s1">&#39;chain 3&#39;</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="n">atable</span><span class="p">)</span>
</pre></div>


<p>Is there evidence to suggest that the chains have converged and that there are enough posterior samples to make proper inference?</p>
<div class="highlight"><pre><span></span><span class="n">library</span><span class="p">(</span><span class="n">coda</span><span class="p">)</span>

<span class="c1"># trace plots</span>
<span class="c1"># theta looks good</span>
<span class="c1"># lambda looks permissible</span>
<span class="n">par</span><span class="p">(</span><span class="n">mfrow</span> <span class="o">=</span> <span class="n">c</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="n">plot</span><span class="p">(</span><span class="n">theta</span><span class="p">[,</span><span class="mi">1</span><span class="p">],</span> <span class="nb">type</span> <span class="o">=</span> <span class="s2">&quot;l&quot;</span><span class="p">,</span> <span class="n">ylab</span> <span class="o">=</span> <span class="s2">&quot;Theta&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="p">(</span><span class="n">j</span> <span class="ow">in</span> <span class="mi">2</span><span class="p">:</span><span class="n">chains</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">lines</span><span class="p">(</span><span class="n">theta</span><span class="p">[,</span><span class="n">j</span><span class="p">],</span> <span class="n">col</span> <span class="o">=</span> <span class="n">j</span><span class="p">)</span>
<span class="p">}</span>

<span class="n">plot</span><span class="p">(</span><span class="k">lambda</span><span class="p">[,</span><span class="mi">1</span><span class="p">],</span> <span class="nb">type</span> <span class="o">=</span> <span class="s2">&quot;l&quot;</span><span class="p">,</span> <span class="n">ylab</span> <span class="o">=</span> <span class="s2">&quot;Lambda&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="p">(</span><span class="n">j</span> <span class="ow">in</span> <span class="mi">2</span><span class="p">:</span><span class="n">chains</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">lines</span><span class="p">(</span><span class="k">lambda</span><span class="p">[,</span><span class="n">j</span><span class="p">],</span> <span class="n">col</span> <span class="o">=</span> <span class="n">j</span><span class="p">)</span>
<span class="p">}</span>
</pre></div>


<p>Set the burn-in amount to 2000 by looking at the trace plots. Autocorrelation plots look good since the lags decay quickly. Effective sample sizes seem permissible. Gelman and Rubin diagnostics are all less than 1.1 which is a good sign.</p>
<div class="highlight"><pre><span></span><span class="c1"># burn-in amount: 2000</span>
<span class="c1"># chosen by looking at the trace plots</span>
<span class="n">burnin</span> <span class="o">&lt;-</span> <span class="mi">2000</span>
<span class="n">plot</span><span class="p">(</span><span class="n">theta</span><span class="p">[(</span><span class="n">burnin</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span><span class="n">mcmc_samples</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="nb">type</span> <span class="o">=</span> <span class="s2">&quot;l&quot;</span><span class="p">,</span> <span class="n">ylab</span> <span class="o">=</span> <span class="s2">&quot;MCMC samples for theta&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="p">(</span><span class="n">j</span> <span class="ow">in</span> <span class="mi">2</span><span class="p">:</span><span class="n">chains</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">lines</span><span class="p">(</span><span class="n">theta</span><span class="p">[(</span><span class="n">burnin</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span><span class="n">mcmc_samples</span><span class="p">,</span><span class="n">j</span><span class="p">],</span> <span class="n">col</span> <span class="o">=</span> <span class="n">j</span><span class="p">)</span>
<span class="p">}</span>
<span class="n">plot</span><span class="p">(</span><span class="k">lambda</span><span class="p">[(</span><span class="n">burnin</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span><span class="n">mcmc_samples</span><span class="p">],</span> <span class="nb">type</span> <span class="o">=</span> <span class="s2">&quot;l&quot;</span><span class="p">,</span> <span class="n">ylab</span> <span class="o">=</span> <span class="s2">&quot;MCMC samples for lambda&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="p">(</span><span class="n">j</span> <span class="ow">in</span> <span class="mi">2</span><span class="p">:</span><span class="n">chains</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">lines</span><span class="p">(</span><span class="k">lambda</span><span class="p">[(</span><span class="n">burnin</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span><span class="n">mcmc_samples</span><span class="p">,</span><span class="n">j</span><span class="p">],</span> <span class="n">col</span> <span class="o">=</span> <span class="n">j</span><span class="p">)</span>
<span class="p">}</span>

<span class="c1"># autocorrelation plots look good</span>
<span class="c1"># lags decay quickly</span>
<span class="n">par</span><span class="p">(</span><span class="n">mfrow</span> <span class="o">=</span> <span class="n">c</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="k">for</span> <span class="p">(</span><span class="n">j</span> <span class="ow">in</span> <span class="mi">1</span><span class="p">:</span><span class="n">chains</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">acf</span><span class="p">(</span><span class="n">theta</span><span class="p">[(</span><span class="n">burnin</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span><span class="n">mcmc_samples</span><span class="p">,</span><span class="n">j</span><span class="p">])</span>
  <span class="n">acf</span><span class="p">(</span><span class="k">lambda</span><span class="p">[(</span><span class="n">burnin</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span><span class="n">mcmc_samples</span><span class="p">,</span><span class="n">j</span><span class="p">])</span>
<span class="p">}</span>

<span class="c1"># effective sample sizes are permissible</span>
<span class="n">ess_theta</span> <span class="o">&lt;-</span> <span class="n">ess_lambda</span> <span class="o">&lt;-</span> <span class="n">rep</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">times</span> <span class="o">=</span> <span class="n">chains</span><span class="p">)</span>
<span class="k">for</span> <span class="p">(</span><span class="n">j</span> <span class="ow">in</span> <span class="mi">1</span><span class="p">:</span><span class="n">chains</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">ess_theta</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">&lt;-</span> <span class="n">effectiveSize</span><span class="p">(</span><span class="n">theta</span><span class="p">[(</span><span class="n">burnin</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span><span class="n">mcmc_samples</span><span class="p">,</span><span class="n">j</span><span class="p">])</span>
  <span class="n">ess_lambda</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">&lt;-</span> <span class="n">effectiveSize</span><span class="p">(</span><span class="k">lambda</span><span class="p">[(</span><span class="n">burnin</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span><span class="n">mcmc_samples</span><span class="p">,</span><span class="n">j</span><span class="p">])</span>
<span class="p">}</span>
<span class="n">etable</span> <span class="o">&lt;-</span> <span class="n">rbind</span><span class="p">(</span><span class="n">ess_theta</span><span class="p">,</span> <span class="n">ess_lambda</span><span class="p">)</span>
<span class="n">dimnames</span><span class="p">(</span><span class="n">etable</span><span class="p">)</span> <span class="o">&lt;-</span> <span class="nb">list</span><span class="p">(</span><span class="n">c</span><span class="p">(</span><span class="s1">&#39;ESS theta&#39;</span><span class="p">,</span> <span class="s1">&#39;ESS lambda&#39;</span><span class="p">),</span>
                         <span class="n">c</span><span class="p">(</span><span class="s1">&#39;Chain 1&#39;</span><span class="p">,</span> <span class="s1">&#39;Chain 2&#39;</span><span class="p">,</span> <span class="s1">&#39;Chain 3&#39;</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="n">etable</span><span class="p">)</span>

<span class="c1"># Geweke diagnostics</span>
<span class="n">gew_theta</span> <span class="o">&lt;-</span> <span class="n">gew_lambda</span> <span class="o">&lt;-</span> <span class="n">rep</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">times</span> <span class="o">=</span> <span class="n">chains</span><span class="p">)</span>
<span class="k">for</span> <span class="p">(</span><span class="n">j</span> <span class="ow">in</span> <span class="mi">1</span><span class="p">:</span><span class="n">chains</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">gew_theta</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">&lt;-</span> <span class="nb">round</span><span class="p">(</span><span class="n">geweke</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">theta</span><span class="p">[(</span><span class="n">burnin</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span><span class="n">mcmc_samples</span><span class="p">,</span><span class="n">j</span><span class="p">])[[</span><span class="mi">1</span><span class="p">]],</span> <span class="mi">3</span><span class="p">)</span>
  <span class="n">gew_lambda</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">&lt;-</span> <span class="nb">round</span><span class="p">(</span><span class="n">geweke</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="k">lambda</span><span class="p">[(</span><span class="n">burnin</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span><span class="n">mcmc_samples</span><span class="p">,</span><span class="n">j</span><span class="p">])[[</span><span class="mi">1</span><span class="p">]],</span> <span class="mi">3</span><span class="p">)</span>
<span class="p">}</span>
<span class="n">gtable</span> <span class="o">&lt;-</span> <span class="n">rbind</span><span class="p">(</span><span class="n">gew_theta</span><span class="p">,</span> <span class="n">gew_lambda</span><span class="p">)</span>
<span class="n">dimnames</span><span class="p">(</span><span class="n">gtable</span><span class="p">)</span> <span class="o">&lt;-</span> <span class="nb">list</span><span class="p">(</span><span class="n">c</span><span class="p">(</span><span class="s1">&#39;Geweke theta&#39;</span><span class="p">,</span> <span class="s1">&#39;Geweke lambda&#39;</span><span class="p">),</span>
                         <span class="n">c</span><span class="p">(</span><span class="s1">&#39;Chain 1&#39;</span><span class="p">,</span> <span class="s1">&#39;Chain 2&#39;</span><span class="p">,</span> <span class="s1">&#39;Chain 3&#39;</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="n">gtable</span><span class="p">)</span>

<span class="c1"># Gelman and Rubin diagnostics</span>
<span class="c1"># all is less than 1.1 which is a good sign</span>
<span class="n">total_count</span> <span class="o">&lt;-</span> <span class="n">mcmc_samples</span> <span class="o">-</span> <span class="n">burnin</span>
<span class="n">keep_set1</span> <span class="o">&lt;-</span> <span class="n">seq</span><span class="p">((</span><span class="n">burnin</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="n">burnin</span><span class="o">+</span><span class="p">(</span><span class="n">total_count</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">keep_set2</span> <span class="o">&lt;-</span> <span class="n">seq</span><span class="p">(</span><span class="n">burnin</span><span class="o">+</span><span class="p">(</span><span class="n">total_count</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">mcmc_samples</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">mh</span><span class="o">.</span><span class="n">list1</span> <span class="o">&lt;-</span> <span class="nb">list</span><span class="p">(</span><span class="k">as</span><span class="o">.</span><span class="n">mcmc</span><span class="p">(</span><span class="n">theta</span><span class="p">[</span><span class="n">keep_set1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span> 
                 <span class="k">as</span><span class="o">.</span><span class="n">mcmc</span><span class="p">(</span><span class="n">theta</span><span class="p">[</span><span class="n">keep_set2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span>
                 <span class="k">as</span><span class="o">.</span><span class="n">mcmc</span><span class="p">(</span><span class="n">theta</span><span class="p">[</span><span class="n">keep_set1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]),</span>
                 <span class="k">as</span><span class="o">.</span><span class="n">mcmc</span><span class="p">(</span><span class="n">theta</span><span class="p">[</span><span class="n">keep_set2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]),</span>
                 <span class="k">as</span><span class="o">.</span><span class="n">mcmc</span><span class="p">(</span><span class="n">theta</span><span class="p">[</span><span class="n">keep_set1</span><span class="p">,</span> <span class="mi">3</span><span class="p">]),</span>
                 <span class="k">as</span><span class="o">.</span><span class="n">mcmc</span><span class="p">(</span><span class="n">theta</span><span class="p">[</span><span class="n">keep_set2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]))</span>
<span class="n">mh</span><span class="o">.</span><span class="n">list1t</span> <span class="o">&lt;-</span> <span class="n">mcmc</span><span class="o">.</span><span class="n">list</span><span class="p">(</span><span class="n">mh</span><span class="o">.</span><span class="n">list1</span><span class="p">)</span>
<span class="n">gelman</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">mh</span><span class="o">.</span><span class="n">list1t</span><span class="p">)</span><span class="err">$</span><span class="n">psrf</span>

<span class="n">mh</span><span class="o">.</span><span class="n">list2</span> <span class="o">&lt;-</span> <span class="nb">list</span><span class="p">(</span><span class="k">as</span><span class="o">.</span><span class="n">mcmc</span><span class="p">(</span><span class="k">lambda</span><span class="p">[</span><span class="n">keep_set1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span> 
                 <span class="k">as</span><span class="o">.</span><span class="n">mcmc</span><span class="p">(</span><span class="k">lambda</span><span class="p">[</span><span class="n">keep_set2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span>
                 <span class="k">as</span><span class="o">.</span><span class="n">mcmc</span><span class="p">(</span><span class="k">lambda</span><span class="p">[</span><span class="n">keep_set1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]),</span> 
                 <span class="k">as</span><span class="o">.</span><span class="n">mcmc</span><span class="p">(</span><span class="k">lambda</span><span class="p">[</span><span class="n">keep_set2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]),</span>
                 <span class="k">as</span><span class="o">.</span><span class="n">mcmc</span><span class="p">(</span><span class="k">lambda</span><span class="p">[</span><span class="n">keep_set1</span><span class="p">,</span> <span class="mi">3</span><span class="p">]),</span> 
                 <span class="k">as</span><span class="o">.</span><span class="n">mcmc</span><span class="p">(</span><span class="k">lambda</span><span class="p">[</span><span class="n">keep_set2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]))</span>
<span class="n">mh</span><span class="o">.</span><span class="n">list2l</span> <span class="o">&lt;-</span> <span class="n">mcmc</span><span class="o">.</span><span class="n">list</span><span class="p">(</span><span class="n">mh</span><span class="o">.</span><span class="n">list2</span><span class="p">)</span>
<span class="n">gelman</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">mh</span><span class="o">.</span><span class="n">list2l</span><span class="p">)</span><span class="err">$</span><span class="n">psrf</span>
</pre></div>


<p>The posterior mean is . The posterior standard deviation is . The 95% quantile-based, equal tail credible interval estimate for <span class="math">\(\theta\)</span> is , and that for <span class="math">\(\lambda\)</span> is .</p>
<div class="highlight"><pre><span></span><span class="c1"># final inference for theta and lambda</span>
<span class="n">full_theta</span> <span class="o">&lt;-</span> <span class="n">theta</span><span class="p">[(</span><span class="n">burnin</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span><span class="n">mcmc_samples</span><span class="p">]</span>
<span class="n">hist</span><span class="p">(</span><span class="n">full_theta</span><span class="p">)</span>
<span class="n">quantile</span><span class="p">(</span><span class="n">full_theta</span><span class="p">,</span> <span class="n">c</span><span class="p">(</span><span class="mf">0.025</span><span class="p">,</span> <span class="mf">0.975</span><span class="p">))</span>
<span class="n">mean</span><span class="p">(</span><span class="n">full_theta</span><span class="p">)</span>
<span class="n">sd</span><span class="p">(</span><span class="n">full_theta</span><span class="p">)</span>

<span class="n">full_lambda</span> <span class="o">&lt;-</span> <span class="k">lambda</span><span class="p">[(</span><span class="n">burnin</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span><span class="n">mcmc_samples</span><span class="p">]</span>
<span class="n">hist</span><span class="p">(</span><span class="n">full_lambda</span><span class="p">)</span>
<span class="n">quantile</span><span class="p">(</span><span class="n">full_lambda</span><span class="p">,</span> <span class="n">c</span><span class="p">(</span><span class="mf">0.025</span><span class="p">,</span> <span class="mf">0.975</span><span class="p">))</span>
<span class="n">mean</span><span class="p">(</span><span class="n">full_lambda</span><span class="p">)</span>
<span class="n">sd</span><span class="p">(</span><span class="n">full_theta</span><span class="p">)</span>
</pre></div>


<script type="text/javascript">if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var align = "center",
        indent = "0em",
        linebreak = "false";

    if (false) {
        align = (screen.width < 768) ? "left" : align;
        indent = (screen.width < 768) ? "0em" : indent;
        linebreak = (screen.width < 768) ? 'true' : linebreak;
    }

    var mathjaxscript = document.createElement('script');
    var location_protocol = (false) ? 'https' : document.location.protocol;
    if (location_protocol !== 'http' && location_protocol !== 'https') location_protocol = 'https:';
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = location_protocol + '//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: '"+ align +"'," +
        "    displayIndent: '"+ indent +"'," +
        "    showMathMenu: true," +
        "    messageStyle: 'normal'," +
        "    tex2jax: { " +
        "        inlineMath: [ ['\\\\(','\\\\)'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'inherit ! important'} }," +
        "        linebreaks: { automatic: "+ linebreak +", width: '90% container' }," +
        "    }, " +
        "}); " +
        "if ('default' !== 'default') {" +
            "MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
            "MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
        "}";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
</script>
  </div>
  <div class="tag-cloud">
    <p>
      <a href="https://stathwang.github.io/tag/zero-inflated-poisson.html">zero inflated poisson</a>
      <a href="https://stathwang.github.io/tag/mcmc.html">mcmc</a>
      <a href="https://stathwang.github.io/tag/bayesian-statistics.html">bayesian statistics</a>
      <a href="https://stathwang.github.io/tag/statistics.html">statistics</a>
      <a href="https://stathwang.github.io/tag/r.html">r</a>
    </p>
  </div>
<div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'thedatalogical';
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
</article>

    <hr />
    <p />
    <!-- Begin MailChimp Signup Form -->
<link href="//cdn-images.mailchimp.com/embedcode/horizontal-slim-10_7.css" rel="stylesheet" type="text/css">
<style type="text/css">
  #mc_embed_signup{background:#fff; clear:left; font:14px Helvetica,Arial,sans-serif; width:100%;}
  /* Add your own MailChimp form style overrides in your site stylesheet or in this style block.
     We recommend moving this block and the preceding CSS link to the HEAD of your HTML file. */
</style>
<div id="mc_embed_signup">
<form action="//github.us1.list-manage.com/subscribe/post?u=0f2c943c221c777ef88591fb6&amp;id=6cf4236c90" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate>
    <div id="mc_embed_signup_scroll">
  <label for="mce-EMAIL">Subscribe to my sporadic data science newsletter and blog post</label>
  <input type="email" value="" name="EMAIL" class="email" id="mce-EMAIL" placeholder="email address" required>
    <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups-->
    <div style="position: absolute; left: -5000px;" aria-hidden="true"><input type="text" name="b_0f2c943c221c777ef88591fb6_6cf4236c90" tabindex="-1" value=""></div>
    <div class="clear"><input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" class="button"></div>
    </div>
</form>
</div>
<br />
<br />

<!--End mc_embed_signup-->

    <footer>
<p>
  &copy; Seong Hyun Hwang 2015 - 2017 - This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>
</p>
<p>
  <a rel="license"
     href="http://creativecommons.org/licenses/by-sa/4.0/"
     target="_blank">
    <img alt="Creative Commons License"
         title="Creative Commons License"
         style="border-width:0"
         src="https://i.creativecommons.org/l/by-sa/4.0/80x15.png"
         width="80"
         height="15"/>
  </a>
</p>    </footer>
  </main>

<!-- Google Analytics -->
<script type="text/javascript">
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-69797568-1', 'auto');
  ga('send', 'pageview');
</script>
<!-- End Google Analytics -->
  <script type="text/javascript" src="//s3.amazonaws.com/downloads.mailchimp.com/js/signup-forms/popup/embed.js" data-dojo-config="usePlainJson: true, isDebug: false"></script><script type="text/javascript">require(["mojo/signup-forms/Loader"], function(L) { L.start({"baseUrl":"mc.us1.list-manage.com","uuid":"0f2c943c221c777ef88591fb6","lid":"6cf4236c90"}) })</script>



<!-- Piwik -->
<script type="text/javascript">
  var _paq = _paq || [];
  _paq.push(['trackPageView']);
  _paq.push(['enableLinkTracking']);
  (function() {
    var u="//" + stathwang.piwikpro.com + "/";
    _paq.push(['setTrackerUrl', u+'piwik.php']);
    _paq.push(['setSiteId', 1]);
    var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
    g.type='text/javascript'; g.async=true; g.defer=true; g.src=u+'piwik.js'; s.parentNode.insertBefore(g,s);
  })();
</script>
<noscript><p><img src="//bnjbvr.alwaysdata.net/piwik/piwik.php?idsite=1" style="border:0;" alt="" /></p></noscript>
<!-- End Piwik Code -->
<script type="application/ld+json">
{
  "@context" : "http://schema.org",
  "@type" : "Blog",
  "name": " Seong Hyun Hwang ",
  "url" : "https://stathwang.github.io",
  "image": "http://www.gravatar.com/avatar/ea0e94239070aef9781e64fb53facf13?s=120&d=http%3A%2F%2Fwww.example.com%2Fdefault.jpg",
  "description": "Seong Hyun Hwang's Thoughts and Writings"
}
</script>
<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "BlogPosting",
  "name": "Bayesian Zero-Inflated Poisson Model",
  "headline": "Bayesian Zero-Inflated Poisson Model",
  "datePublished": "2017-07-05 19:30:00-04:00",
  "dateModified": "",
  "author": {
    "@type": "Person",
    "name": "Seong Hyun Hwang",
    "url": "https://stathwang.github.io/author/seong-hyun-hwang.html"
  },
  "image": "http://www.gravatar.com/avatar/ea0e94239070aef9781e64fb53facf13?s=120&d=http%3A%2F%2Fwww.example.com%2Fdefault.jpg",
  "url": "https://stathwang.github.io/bayesian-zero-inflated-poisson-model.html",
  "description": "Wikipedia defines: The zero-inflated Poisson model concerns a random event containing excess zero-count data in unit time. For instance, the number of insurance claims within a population for a certain type of risk would be zero-inflated by those people who have not taken out insurance against the risk and thus …"
}
</script></body>
</html>