<!DOCTYPE html>
<html lang="en">
<head>
  <link href='//fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,700,400italic' rel='stylesheet' type='text/css'>

    <link rel="stylesheet" type="text/css" href="https://stathwang.github.io/theme/stylesheet/style.min.css">

  <link rel="stylesheet" type="text/css" href="https://stathwang.github.io/theme/pygments/monokai.min.css">
  <link rel="stylesheet" type="text/css" href="https://stathwang.github.io/theme/font-awesome/css/font-awesome.min.css">


    <link href="https://stathwang.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Seong Hyun Hwang Atom">



  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="robots" content="" />

    <!-- Chrome, Firefox OS and Opera -->
    <meta name="theme-color" content="#333333">
    <!-- Windows Phone -->
    <meta name="msapplication-navbutton-color" content="#333333">
    <!-- iOS Safari -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

<meta name="author" content="Seong Hyun Hwang" />
<meta name="description" content="Introduction The field of spatial statistics is experiencing a period of rapid growth, though less so compared to that of machine learning and artificial intelligence, with the onset of location technology and efficient solution techniques for high performance computing, which has begun to replace classical frequentist inference procedures developed years …" />
<meta name="keywords" content="point process models, spatial statistics, r">
<meta property="og:site_name" content="Seong Hyun Hwang"/>
<meta property="og:title" content="Predicting Free Public WiFi Locations in Seoul with Point Process Models using Foursquare API"/>
<meta property="og:description" content="Introduction The field of spatial statistics is experiencing a period of rapid growth, though less so compared to that of machine learning and artificial intelligence, with the onset of location technology and efficient solution techniques for high performance computing, which has begun to replace classical frequentist inference procedures developed years …"/>
<meta property="og:locale" content="en_US"/>
<meta property="og:url" content="https://stathwang.github.io/predicting-free-public-wifi-locations-in-seoul-with-point-process-models-using-foursquare-api.html"/>
<meta property="og:type" content="article"/>
<meta property="article:published_time" content="2017-06-25 01:45:00-04:00"/>
<meta property="article:modified_time" content=""/>
<meta property="article:author" content="https://stathwang.github.io/author/seong-hyun-hwang.html">
<meta property="article:section" content="Spatial Statistics"/>
<meta property="article:tag" content="point process models"/>
<meta property="article:tag" content="spatial statistics"/>
<meta property="article:tag" content="r"/>
<meta property="og:image" content="http://www.gravatar.com/avatar/ea0e94239070aef9781e64fb53facf13?s=120&d=http%3A%2F%2Fwww.example.com%2Fdefault.jpg">
  <title>Seong Hyun Hwang &ndash; Predicting Free Public WiFi Locations in Seoul with Point Process Models using Foursquare API</title>
</head>
<body>
  <aside>
    <div>
      <a href="https://stathwang.github.io">
        <img src="http://www.gravatar.com/avatar/ea0e94239070aef9781e64fb53facf13?s=120&d=http%3A%2F%2Fwww.example.com%2Fdefault.jpg" alt="Seong Hyun Hwang" title="Seong Hyun Hwang">
      </a>
      <h1><a href="https://stathwang.github.io">Seong Hyun Hwang</a></h1>
<p>Data Scientist - Product Developer</p>      <nav>
        <ul class="list">
          <li><a href="https://stathwang.github.io/pages/about.html#about">about</a></li>
          <li><a href="https://stathwang.github.io/pages/photos.html#photos">photos</a></li>
          <li><a href="https://stathwang.github.io/pages/projects.html#projects">projects</a></li>
        </ul>
      </nav>
      <ul class="social">
        <li><a class="sc-github" href="https://github.com/stathwang" target="_blank"><i class="fa fa-github"></i></a></li>
        <li><a class="sc-google" href="https://plus.google.com/112356517445062778569" target="_blank"><i class="fa fa-google"></i></a></li>
        <li><a class="sc-twitter" href="https://twitter.com/superhugehwang" target="_blank"><i class="fa fa-twitter"></i></a></li>
        <li><a class="sc-rss" href="//stathwang.github.io/feeds/all.atom.xml" target="_blank"><i class="fa fa-rss"></i></a></li>
      </ul>
    </div>
  </aside>
  <main>
    <nav>
      <a href="https://stathwang.github.io">Home</a>
      <a href="/archives.html">Archives</a>
      <a href="/categories.html">Categories</a>
      <a href="/tags.html">Tags</a>
      <a href="https://stathwang.github.io/feeds/all.atom.xml">Atom</a>
    </nav>

<article>
  <header>
    <h1 id="predicting-free-public-wifi-locations-in-seoul-with-point-process-models-using-foursquare-api">Predicting Free Public WiFi Locations in Seoul with Point Process Models using Foursquare API</h1>
    <p>Posted on June 25 2017 in <a href="https://stathwang.github.io/category/spatial-statistics.html">Spatial Statistics</a></p>
  </header>
  <div>
    <h3>Introduction</h3>
<p>The field of spatial statistics is experiencing a period of rapid growth, though less so compared to that of machine learning and artificial intelligence, with the onset of location technology and efficient solution techniques for high performance computing, which has begun to replace classical frequentist inference procedures developed years ago with Bayesian methods. </p>
<p>A point process, in particular, is a special kind of stochastic process where each <span class="math">\(X_i\)</span> is the numeric representation of a point location in space, usually planar. Diggle (2013) puts it nicely: <em>"A spatial point pattern is a set of locations, irregularly distributed within a designated region and presumed to have been generated by some form of stochastic mechanism (p. xxix)"</em>. The equivalent of a linear model in spatial statistics is a <strong>point process model</strong> that takes into account spatial coordinates of points and geographical features. </p>
<p>In this post, I'm going to fit point process models on the dataset of free public WiFi locations in Seoul, Korea downloaded from <a href="http://data.seoul.go.kr/">Seoul Open Data Plaza</a> and predict the probability of seeing a free public WiFi at a given location within Seoul using location data grabbed from the <a href="https://developer.foursquare.com/">Foursquare API</a>.</p>
<h3>WiFi Location Dataset</h3>
<p>The dataset <code>seoul-public-wifi-cleaned.csv</code> consists of 2385 spatial points with 6 columns that are the name of the place where a free public WiFi is installed, xy-coordinate (longitude and latitude) of the place, WiFi network provider, municipal unit, and location type. Each point can be one of 3 WiFi network providers: <em>KT</em>, <em>SKT</em>, and <em>LGU+</em> and one of 12 location types: <em>bus stops</em>, <em>community centers</em>, <em>cultural facilities</em>, <em>health facilities</em>, <em>main streets</em>, <em>parks</em>, <em>plazas</em>, <em>public institutions</em>, <em>tourist destinations</em>, <em>traditional markets</em>, <em>walking trails</em>, and <em>welfare facilities</em>.</p>
<div class="highlight"><pre><span></span><span class="n">library</span><span class="p">(</span><span class="n">RCurl</span><span class="p">)</span>
<span class="n">library</span><span class="p">(</span><span class="n">jsonlite</span><span class="p">)</span>
<span class="n">library</span><span class="p">(</span><span class="n">plyr</span><span class="p">)</span>
<span class="n">library</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">table</span><span class="p">)</span>
<span class="n">library</span><span class="p">(</span><span class="n">rgdal</span><span class="p">)</span>
<span class="n">library</span><span class="p">(</span><span class="n">spdep</span><span class="p">)</span>
<span class="n">library</span><span class="p">(</span><span class="n">splancs</span><span class="p">)</span>
<span class="n">library</span><span class="p">(</span><span class="n">spatstat</span><span class="p">)</span>
<span class="n">library</span><span class="p">(</span><span class="n">ggmap</span><span class="p">)</span>

<span class="n">wifi</span> <span class="o">&lt;-</span> <span class="n">fread</span><span class="p">(</span><span class="s2">&quot;seoul-public-wifi-cleaned.csv&quot;</span><span class="p">)</span>
</pre></div>


<p>The distribution of WiFi network providers and that of location categories are plotted as follows. I borrowed the <a href="http://www.cookbook-r.com/Graphs/Multiple_graphs_on_one_page_(ggplot2)/">multiplot</a> function to plot two graphs in a single window. About 55% of free public WiFis are located in the main streets and parks. WiFi network providers SKT and LGU+ serve nearly 75% of the locations.</p>
<p><img alt="wifiplots" src="https://stathwang.github.io/images/wifiplots.png"></p>
<div class="highlight"><pre><span></span><span class="n">w1</span> <span class="o">&lt;-</span> <span class="n">wifi</span><span class="p">[,</span> <span class="o">.</span><span class="n">N</span><span class="p">,</span> <span class="n">cat</span><span class="p">][</span><span class="n">order</span><span class="p">(</span><span class="o">-</span><span class="n">N</span><span class="p">)]</span>
<span class="n">w2</span> <span class="o">&lt;-</span> <span class="n">wifi</span><span class="p">[,</span> <span class="o">.</span><span class="n">N</span><span class="p">,</span> <span class="n">comp</span><span class="p">][</span><span class="n">order</span><span class="p">(</span><span class="o">-</span><span class="n">N</span><span class="p">)]</span>
<span class="n">w1</span><span class="err">$</span><span class="n">cat</span> <span class="o">&lt;-</span> <span class="n">factor</span><span class="p">(</span><span class="n">w1</span><span class="err">$</span><span class="n">cat</span><span class="p">,</span> <span class="n">levels</span> <span class="o">=</span> <span class="n">rev</span><span class="p">(</span><span class="k">as</span><span class="o">.</span><span class="n">character</span><span class="p">(</span><span class="n">w1</span><span class="err">$</span><span class="n">cat</span><span class="p">)))</span>
<span class="n">w2</span><span class="err">$</span><span class="n">comp</span> <span class="o">&lt;-</span> <span class="n">factor</span><span class="p">(</span><span class="n">w2</span><span class="err">$</span><span class="n">comp</span><span class="p">,</span> <span class="n">levels</span> <span class="o">=</span> <span class="k">as</span><span class="o">.</span><span class="n">character</span><span class="p">(</span><span class="n">w2</span><span class="err">$</span><span class="n">comp</span><span class="p">))</span>
<span class="n">p1</span> <span class="o">&lt;-</span> <span class="n">ggplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">w1</span><span class="p">,</span> <span class="n">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">cat</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">N</span><span class="p">))</span> <span class="o">+</span> 
  <span class="n">geom_bar</span><span class="p">(</span><span class="n">stat</span> <span class="o">=</span> <span class="s2">&quot;identity&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">coord_flip</span><span class="p">()</span> <span class="o">+</span> 
  <span class="n">geom_text</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">label</span> <span class="o">=</span> <span class="n">N</span><span class="p">),</span> <span class="n">position</span> <span class="o">=</span> <span class="n">position_dodge</span><span class="p">(</span><span class="n">width</span> <span class="o">=</span> <span class="mf">0.9</span><span class="p">),</span> <span class="n">hjust</span> <span class="o">=</span> <span class="mf">1.2</span><span class="p">,</span> <span class="n">colour</span> <span class="o">=</span> <span class="s2">&quot;white&quot;</span><span class="p">)</span> <span class="o">+</span> 
  <span class="n">labs</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s2">&quot;Number of Spatial Points&quot;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s2">&quot;Location Types&quot;</span><span class="p">,</span> <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Barplot of Location Types&quot;</span><span class="p">)</span>
<span class="n">p2</span> <span class="o">&lt;-</span> <span class="n">ggplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">w2</span><span class="p">,</span> <span class="n">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">comp</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">N</span><span class="p">))</span> <span class="o">+</span> 
  <span class="n">geom_bar</span><span class="p">(</span><span class="n">stat</span> <span class="o">=</span> <span class="s2">&quot;identity&quot;</span><span class="p">,</span> <span class="n">width</span> <span class="o">=</span> <span class="mf">0.7</span><span class="p">)</span> <span class="o">+</span> 
  <span class="n">geom_text</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">label</span> <span class="o">=</span> <span class="n">N</span><span class="p">),</span> <span class="n">position</span> <span class="o">=</span> <span class="n">position_dodge</span><span class="p">(</span><span class="n">width</span> <span class="o">=</span> <span class="mf">0.9</span><span class="p">),</span> <span class="n">vjust</span> <span class="o">=</span> <span class="mf">1.5</span><span class="p">,</span> <span class="n">colour</span> <span class="o">=</span> <span class="s2">&quot;white&quot;</span><span class="p">)</span> <span class="o">+</span> 
  <span class="n">labs</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s2">&quot;WiFi Network Providers&quot;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s2">&quot;Number of Spatial Points&quot;</span><span class="p">,</span> <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Barplot of WiFi Network Providers&quot;</span><span class="p">)</span>
<span class="n">multiplot</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">,</span> <span class="n">cols</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>


<p>Spatially join the points with the Seoul municipalities shapefile <code>seoul_municipalities.shp</code> and plot the points on top of the municipality boundaries (not shown). Plot the points and contours of a 2D kernel density estimate on the actual geographical map of Seoul.</p>
<div class="highlight"><pre><span></span><span class="n">shape</span> <span class="o">&lt;-</span> <span class="n">readOGR</span><span class="p">(</span><span class="s2">&quot;seoul_municipalities.shp&quot;</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">shape</span><span class="p">)</span>

<span class="n">kt</span><span class="o">.</span><span class="n">list</span> <span class="o">&lt;-</span> <span class="nb">list</span><span class="p">()</span>
<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="ow">in</span> <span class="mi">1</span><span class="p">:</span><span class="n">length</span><span class="p">(</span><span class="n">shape</span><span class="nd">@polygons</span><span class="p">))</span> <span class="p">{</span>
  <span class="n">kt</span> <span class="o">&lt;-</span> <span class="n">shape</span><span class="nd">@polygons</span><span class="p">[[</span><span class="n">i</span><span class="p">]]</span><span class="nd">@Polygons</span><span class="p">[[</span><span class="mi">1</span><span class="p">]]</span><span class="nd">@coords</span>
  <span class="n">kt</span><span class="o">.</span><span class="n">list</span><span class="p">[[</span><span class="n">i</span><span class="p">]]</span> <span class="o">&lt;-</span> <span class="n">kt</span>
<span class="p">}</span>

<span class="n">kt</span><span class="o">.</span><span class="n">list</span> <span class="o">&lt;-</span> <span class="n">do</span><span class="o">.</span><span class="n">call</span><span class="p">(</span><span class="n">rbind</span><span class="p">,</span> <span class="n">kt</span><span class="o">.</span><span class="n">list</span><span class="p">)</span>

<span class="n">wifi</span><span class="o">.</span><span class="n">pts</span> <span class="o">&lt;-</span> <span class="k">as</span><span class="o">.</span><span class="n">points</span><span class="p">(</span><span class="n">wifi</span><span class="err">$</span><span class="n">lng</span><span class="p">,</span> <span class="n">wifi</span><span class="err">$</span><span class="n">lat</span><span class="p">)</span>
<span class="n">wifi</span><span class="o">.</span><span class="n">poly</span> <span class="o">&lt;-</span> <span class="k">as</span><span class="o">.</span><span class="n">points</span><span class="p">(</span><span class="n">kt</span><span class="o">.</span><span class="n">list</span><span class="p">[,</span><span class="mi">1</span><span class="p">],</span> <span class="n">kt</span><span class="o">.</span><span class="n">list</span><span class="p">[,</span><span class="mi">2</span><span class="p">])</span>
<span class="n">wfppp</span> <span class="o">&lt;-</span> <span class="n">ppp</span><span class="p">(</span><span class="n">wifi</span><span class="o">.</span><span class="n">pts</span><span class="p">[,</span><span class="mi">1</span><span class="p">],</span> <span class="n">wifi</span><span class="o">.</span><span class="n">pts</span><span class="p">[,</span><span class="mi">2</span><span class="p">],</span>
             <span class="nb">xrange</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">wifi</span><span class="o">.</span><span class="n">poly</span><span class="p">[,</span><span class="mi">1</span><span class="p">]),</span>
             <span class="n">yrange</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">wifi</span><span class="o">.</span><span class="n">poly</span><span class="p">[,</span><span class="mi">2</span><span class="p">]))</span>

<span class="n">par</span><span class="p">(</span><span class="n">mfrow</span> <span class="o">=</span> <span class="n">c</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="n">plot</span><span class="p">(</span><span class="n">wifi</span><span class="o">.</span><span class="n">pts</span><span class="p">[,</span><span class="mi">1</span><span class="p">],</span> <span class="n">wifi</span><span class="o">.</span><span class="n">pts</span><span class="p">[,</span><span class="mi">2</span><span class="p">],</span> <span class="n">pch</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span> <span class="n">cex</span> <span class="o">=</span> <span class="mf">1.2</span><span class="p">)</span>
<span class="n">polymap</span><span class="p">(</span><span class="n">wifi</span><span class="o">.</span><span class="n">poly</span><span class="p">,</span> <span class="n">add</span> <span class="o">=</span> <span class="n">TRUE</span><span class="p">)</span>

<span class="n">seoul_map</span> <span class="o">&lt;-</span> <span class="n">qmap</span><span class="p">(</span><span class="s1">&#39;seoul&#39;</span><span class="p">,</span> <span class="n">zoom</span> <span class="o">=</span> <span class="mi">11</span><span class="p">,</span> <span class="n">maptype</span> <span class="o">=</span> <span class="s1">&#39;roadmap&#39;</span><span class="p">)</span>
<span class="n">q</span> <span class="o">&lt;-</span> <span class="n">seoul_map</span> <span class="o">+</span> 
  <span class="n">geom_point</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">wifi</span><span class="p">,</span> <span class="n">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">lng</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">lat</span><span class="p">))</span> <span class="o">+</span> 
  <span class="n">geom_polygon</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">wifi</span><span class="p">,</span>
               <span class="n">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">lng</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">lat</span><span class="p">,</span> <span class="n">fill</span> <span class="o">=</span> <span class="o">..</span><span class="n">level</span><span class="o">..</span><span class="p">),</span>
               <span class="n">stat</span> <span class="o">=</span> <span class="s1">&#39;density2d&#39;</span><span class="p">,</span>
               <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
</pre></div>


<p><img alt="singleplot" src="https://stathwang.github.io/images/singleplot.png"></p>
<p>Do the points look clustered, regular, or random? A clustered process means that events, or actual observations, fall into clumped groupings, whereas in a regular process, there are regular spatial intervals between events i.e. if species are pushing against each other by inhibiting growth at too close a distance. Events follow a <strong>completely spatially random</strong> pattern when they are equally likely to occur at any location within the defined region <span class="math">\(R\)</span>. The CSR serves as the baseline for comparison of clustered and regular point processes.</p>
<p>Given a CSR, events follow a uniform distribution over the study region <span class="math">\(R\)</span>:</p>
<div class="math">\begin{equation}
f(x, y) = \dfrac{1}{|R|}
\end{equation}</div>
<p>for all <span class="math">\((x, y) \in R\)</span>, where <span class="math">\(|R|\)</span> is the area of <span class="math">\(R\)</span>. Events are independent. Note that since the area of <span class="math">\(R\)</span> may vary widely, it’s sometimes more helpful to think that the average number of points per unit area is some fixed, constant <span class="math">\(\lambda\)</span> (lambda). This number is called the intensity, or equivalently, the mean. </p>
<p>Poisson distributions are used to model the number of events per unit of space or time. The mean and the variance of a Poisson distribution are all equal to <span class="math">\(\lambda\)</span>. A <strong>homogeneous Poisson point process</strong> is defined as follows:</p>
<ul>
<li>The random number of events <span class="math">\(X\)</span> in a finite region <span class="math">\(A\)</span> has a Poisson distribution with mean <span class="math">\(\lambda|A|\)</span> where <span class="math">\(|A|\)</span> is the area of <span class="math">\(A\)</span> and <span class="math">\(\lambda\)</span> is the intensity.</li>
</ul>
<p><strong>Intensity</strong> is the number of expected events per unit area. For a homogeneous process, this is constant over the area.</p>
<ul>
<li>Given that a total of <span class="math">\(X = N\)</span> events occur in <span class="math">\(A\)</span>, the locations of the events are uniformly distributed across <span class="math">\(A\)</span>.</li>
</ul>
<p>This means that for a CSR, while the observed number of points over a region <span class="math">\(R\)</span> will vary from one realization to the next, the average (expected) number of points is the fixed quantity <span class="math">\(\lambda|R|\)</span>. We can therefore generate a CSR:</p>
<ol>
<li>Generate a Poisson number of points <span class="math">\(X = N\)</span> with mean <span class="math">\(\lambda|R|\)</span>.</li>
<li>Randomly assign locations for the <span class="math">\(N\)</span> according to a uniform distribution.</li>
</ol>
<p>Under the homogeneous Poisson model, the intensity function <span class="math">\(\lambda\)</span> is constant. However, for many processes, a constant risk hypothesis is too restrictive - the intensity varies over a region according to population, gradients, etc. Hence we define a <strong>heterogenous Poisson point process</strong> with intensity function <span class="math">\(\lambda(s)\)</span> where <span class="math">\(s\)</span> is any point in our study region <span class="math">\(R\)</span>, using the criteria:</p>
<ol>
<li>
<p>The number of events in any region <span class="math">\(A \subset R\)</span> has a Poisson distribution with mean <span class="math">\(\int_A \lambda(s)~ds\)</span>.</p>
</li>
<li>
<p>Given that a total of <span class="math">\(X = N\)</span> events occur in <span class="math">\(A\)</span>, the locations of the events are a random sample of <span class="math">\(N\)</span> events sampled proportional to <span class="math">\(\lambda(s)\)</span>.</p>
</li>
</ol>
<p>Let's use the <strong>Clark-Evans test</strong> to show whether the points follow a completely spatially random pattern.</p>
<div class="highlight"><pre><span></span><span class="n">clarkevans</span><span class="o">.</span><span class="n">test</span><span class="p">(</span><span class="n">wfppp</span><span class="p">)</span>
<span class="n">clarkevans</span><span class="o">.</span><span class="n">test</span><span class="p">(</span><span class="n">wfppp</span><span class="p">,</span> <span class="n">alternative</span> <span class="o">=</span> <span class="s2">&quot;clustered&quot;</span><span class="p">)</span>
</pre></div>


<p>Since the p-value is less than 0.05, we reject the null hypothesis that the WiFi locations are completely spatially randomly distributed within Seoul. In fact, the earlier contour plot indicates that points are rather clustered near the center of Seoul where we expect to see a lot of foot traffic.</p>
<h3>K, L, G, F, J Functions</h3>
<p>Surely the points are not CSR but may rather be clustered. Is this clustering of points perhaps due to changing mean <span class="math">\(\lambda\)</span> or spatial correlation over the region? Can we check this departure from CSR graphically? Several measures exist to achieve these: nearest neighbor methods such as the <span class="math">\(G\)</span> and <span class="math">\(F\)</span> functions. However, most common and popular is the Ripley's <span class="math">\(K\)</span> function.</p>
<p>The <span class="math">\(K\)</span> function <span class="math">\(K(r)\)</span> measures the expected number of events within distance <span class="math">\(r\)</span> of a random event divided by <span class="math">\(\lambda\)</span>. Under CSR, <span class="math">\(K(r) = \pi r^2\)</span> which is a parabola. If regular, <span class="math">\(K(r) &lt; \pi r^2\)</span> for <span class="math">\(r\)</span> less than regularity interval; if clustered, <span class="math">\(K(r) &gt; \pi r^2\)</span> for <span class="math">\(r\)</span> less than cluster size.</p>
<p>The <span class="math">\(L\)</span> function <span class="math">\(L(r)\)</span> is <span class="math">\(\sqrt{\dfrac{K(r)}{\pi}} - r\)</span> which is a transformation of <span class="math">\(K(r)\)</span> so that it'd be easier to note departures from CSR if what was <em>normal</em> was a straight line, not a parabola. </p>
<p>On the other hand, the <span class="math">\(G\)</span> function <span class="math">\(G(r)\)</span> is the cumulative probability distribution of nearest neighbor distances between events. The <span class="math">\(F\)</span> function <span class="math">\(F(r)\)</span> is the cumulative probability distribution of nearest neighbor distances from a random point to an event. Remember that an event is an actual observation in region <span class="math">\(R\)</span>, but a point is any other location of interest in the region. The <span class="math">\(J\)</span> function <span class="math">\(J(r)\)</span> is just <span class="math">\(\dfrac{1 - G(r)}{1 - F(r)}\)</span>. My R code below plots all these functions with various border correction methods.</p>
<div class="highlight"><pre><span></span><span class="c1"># K function</span>
<span class="n">Kplot</span> <span class="o">&lt;-</span> <span class="n">function</span><span class="p">(</span><span class="n">envdata</span><span class="p">,</span> <span class="n">Kdata</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">datatitle</span> <span class="o">=</span> <span class="s2">&quot;Data&quot;</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">dataenv</span> <span class="o">&lt;-</span> <span class="n">envdata</span>
  <span class="n">dataK</span> <span class="o">&lt;-</span> <span class="n">Kdata</span>
  <span class="n">plrange</span> <span class="o">&lt;-</span> <span class="nb">range</span><span class="p">(</span><span class="n">c</span><span class="p">(</span><span class="n">dataK</span><span class="err">$</span><span class="n">border</span><span class="p">[</span><span class="ow">is</span><span class="o">.</span><span class="n">finite</span><span class="p">(</span><span class="n">dataK</span><span class="err">$</span><span class="n">border</span><span class="p">)],</span>
                     <span class="n">dataK</span><span class="err">$</span><span class="n">trans</span><span class="p">[</span><span class="ow">is</span><span class="o">.</span><span class="n">finite</span><span class="p">(</span><span class="n">dataK</span><span class="err">$</span><span class="n">trans</span><span class="p">)],</span>
                     <span class="n">dataK</span><span class="err">$</span><span class="n">iso</span><span class="p">[</span><span class="ow">is</span><span class="o">.</span><span class="n">finite</span><span class="p">(</span><span class="n">dataK</span><span class="err">$</span><span class="n">iso</span><span class="p">)],</span>
                     <span class="n">dataenv</span><span class="err">$</span><span class="n">lo</span><span class="p">[</span><span class="ow">is</span><span class="o">.</span><span class="n">finite</span><span class="p">(</span><span class="n">dataenv</span><span class="err">$</span><span class="n">lo</span><span class="p">)],</span>
                     <span class="n">dataenv</span><span class="err">$</span><span class="n">hi</span><span class="p">[</span><span class="ow">is</span><span class="o">.</span><span class="n">finite</span><span class="p">(</span><span class="n">dataenv</span><span class="err">$</span><span class="n">hi</span><span class="p">)]))</span>
  <span class="n">pllength</span> <span class="o">&lt;-</span> <span class="nb">max</span><span class="p">(</span><span class="n">length</span><span class="p">(</span><span class="n">dataK</span><span class="err">$</span><span class="n">border</span><span class="p">[</span><span class="ow">is</span><span class="o">.</span><span class="n">finite</span><span class="p">(</span><span class="n">dataK</span><span class="err">$</span><span class="n">border</span><span class="p">)]),</span>
                  <span class="n">length</span><span class="p">(</span><span class="n">dataK</span><span class="err">$</span><span class="n">trans</span><span class="p">[</span><span class="ow">is</span><span class="o">.</span><span class="n">finite</span><span class="p">(</span><span class="n">dataK</span><span class="err">$</span><span class="n">trans</span><span class="p">)]),</span>
                  <span class="n">length</span><span class="p">(</span><span class="n">dataK</span><span class="err">$</span><span class="n">iso</span><span class="p">[</span><span class="ow">is</span><span class="o">.</span><span class="n">finite</span><span class="p">(</span><span class="n">dataK</span><span class="err">$</span><span class="n">iso</span><span class="p">)]))</span>
  <span class="n">par</span><span class="p">(</span><span class="n">pty</span> <span class="o">=</span> <span class="s2">&quot;m&quot;</span><span class="p">)</span>
  <span class="n">plot</span><span class="p">(</span><span class="n">dataenv</span><span class="err">$</span><span class="n">r</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="n">pllength</span><span class="p">],</span> <span class="n">dataenv</span><span class="err">$</span><span class="n">obs</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="n">pllength</span><span class="p">],</span> <span class="n">pch</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
       <span class="n">main</span> <span class="o">=</span> <span class="n">paste</span><span class="p">(</span><span class="s2">&quot;Ripleys K-plot for&quot;</span><span class="p">,</span> <span class="n">datatitle</span><span class="p">),</span> <span class="n">ylim</span> <span class="o">=</span> <span class="n">plrange</span><span class="p">,</span> <span class="n">xlab</span> <span class="o">=</span> <span class="s2">&quot;Distance (h)&quot;</span><span class="p">,</span> <span class="n">ylab</span> <span class="o">=</span> <span class="s2">&quot;Ripley&#39;s K&quot;</span><span class="p">)</span>
  <span class="n">lines</span><span class="p">(</span><span class="n">dataenv</span><span class="err">$</span><span class="n">r</span><span class="p">,</span> <span class="n">dataenv</span><span class="err">$</span><span class="n">hi</span><span class="p">,</span> <span class="n">lty</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">col</span> <span class="o">=</span> <span class="s2">&quot;Red&quot;</span><span class="p">,</span> <span class="n">lwd</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
  <span class="n">lines</span><span class="p">(</span><span class="n">dataenv</span><span class="err">$</span><span class="n">r</span><span class="p">,</span> <span class="n">dataenv</span><span class="err">$</span><span class="n">lo</span><span class="p">,</span> <span class="n">lty</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">col</span> <span class="o">=</span> <span class="s2">&quot;Red&quot;</span><span class="p">,</span> <span class="n">lwd</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
  <span class="n">lines</span><span class="p">(</span><span class="n">dataK</span><span class="err">$</span><span class="n">r</span><span class="p">,</span> <span class="n">dataK</span><span class="err">$</span><span class="n">theo</span><span class="p">,</span> <span class="n">lty</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">col</span> <span class="o">=</span> <span class="s2">&quot;Black&quot;</span><span class="p">,</span> <span class="n">lwd</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
  <span class="n">lines</span><span class="p">(</span><span class="n">dataK</span><span class="err">$</span><span class="n">r</span><span class="p">,</span> <span class="n">dataK</span><span class="err">$</span><span class="n">border</span><span class="p">,</span> <span class="n">lty</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">col</span> <span class="o">=</span> <span class="s2">&quot;Yellow&quot;</span><span class="p">,</span> <span class="n">lwd</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
  <span class="n">lines</span><span class="p">(</span><span class="n">dataK</span><span class="err">$</span><span class="n">r</span><span class="p">,</span> <span class="n">dataK</span><span class="err">$</span><span class="n">trans</span><span class="p">,</span> <span class="n">lty</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">col</span> <span class="o">=</span> <span class="s2">&quot;Green&quot;</span><span class="p">,</span> <span class="n">lwd</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
  <span class="n">lines</span><span class="p">(</span><span class="n">dataK</span><span class="err">$</span><span class="n">r</span><span class="p">,</span> <span class="n">dataK</span><span class="err">$</span><span class="n">iso</span><span class="p">,</span> <span class="n">lty</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">col</span> <span class="o">=</span> <span class="s2">&quot;Blue&quot;</span><span class="p">,</span> <span class="n">lwd</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
  <span class="n">legend</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">c</span><span class="p">(</span><span class="s2">&quot;CSR&quot;</span><span class="p">,</span> <span class="s2">&quot;Boundaries&quot;</span><span class="p">,</span> <span class="s2">&quot;Border Corrected&quot;</span><span class="p">,</span> <span class="s2">&quot;Trans Corrected&quot;</span><span class="p">,</span> <span class="s2">&quot;Iso Corrected&quot;</span><span class="p">),</span>
         <span class="n">lty</span> <span class="o">=</span> <span class="n">c</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">col</span> <span class="o">=</span> <span class="n">c</span><span class="p">(</span><span class="s2">&quot;Black&quot;</span><span class="p">,</span> <span class="s2">&quot;Red&quot;</span><span class="p">,</span> <span class="s2">&quot;Yellow&quot;</span><span class="p">,</span> <span class="s2">&quot;Green&quot;</span><span class="p">,</span> <span class="s2">&quot;Blue&quot;</span><span class="p">),</span>
         <span class="n">lwd</span> <span class="o">=</span> <span class="n">c</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="n">cex</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">)</span>
<span class="p">}</span>

<span class="c1"># L function</span>
<span class="n">L</span> <span class="o">&lt;-</span> <span class="n">function</span><span class="p">(</span><span class="n">envdata</span><span class="p">,</span> <span class="n">Kdata</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">datatitle</span> <span class="o">=</span> <span class="s2">&quot;Data&quot;</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">dataenv</span> <span class="o">&lt;-</span> <span class="n">envdata</span>
  <span class="n">dataK</span> <span class="o">&lt;-</span> <span class="n">Kdata</span>
  <span class="n">dataenv</span><span class="err">$</span><span class="n">obs</span> <span class="o">&lt;-</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">dataenv</span><span class="err">$</span><span class="n">obs</span><span class="o">/</span><span class="n">pi</span><span class="p">)</span> <span class="o">-</span> <span class="n">dataenv</span><span class="err">$</span><span class="n">r</span>
  <span class="k">if</span> <span class="p">(</span><span class="ow">is</span><span class="o">.</span><span class="n">null</span><span class="p">(</span><span class="n">dataenv</span><span class="err">$</span><span class="n">theo</span><span class="p">)</span> <span class="o">==</span> <span class="n">FALSE</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">dataenv</span><span class="err">$</span><span class="n">theo</span> <span class="o">&lt;-</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">dataenv</span><span class="err">$</span><span class="n">theo</span><span class="o">/</span><span class="n">pi</span><span class="p">)</span> <span class="o">-</span> <span class="n">dataenv</span><span class="err">$</span><span class="n">r</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="n">dataenv</span><span class="err">$</span><span class="n">theo</span> <span class="o">&lt;-</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">dataenv</span><span class="err">$</span><span class="n">mmean</span><span class="o">/</span><span class="n">pi</span><span class="p">)</span> <span class="o">-</span> <span class="n">dataenv</span><span class="err">$</span><span class="n">r</span>
  <span class="p">}</span>
  <span class="n">dataenv</span><span class="err">$</span><span class="n">lo</span> <span class="o">&lt;-</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">dataenv</span><span class="err">$</span><span class="n">lo</span><span class="o">/</span><span class="n">pi</span><span class="p">)</span> <span class="o">-</span> <span class="n">dataenv</span><span class="err">$</span><span class="n">r</span>
  <span class="n">dataenv</span><span class="err">$</span><span class="n">hi</span> <span class="o">&lt;-</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">dataenv</span><span class="err">$</span><span class="n">hi</span><span class="o">/</span><span class="n">pi</span><span class="p">)</span> <span class="o">-</span> <span class="n">dataenv</span><span class="err">$</span><span class="n">r</span>
  <span class="n">dataK</span><span class="err">$</span><span class="n">theo</span> <span class="o">&lt;-</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">dataK</span><span class="err">$</span><span class="n">theo</span><span class="o">/</span><span class="n">pi</span><span class="p">)</span> <span class="o">-</span> <span class="n">dataK</span><span class="err">$</span><span class="n">r</span>
  <span class="n">dataK</span><span class="err">$</span><span class="n">border</span> <span class="o">&lt;-</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">dataK</span><span class="err">$</span><span class="n">border</span><span class="o">/</span><span class="n">pi</span><span class="p">)</span> <span class="o">-</span> <span class="n">dataK</span><span class="err">$</span><span class="n">r</span>
  <span class="n">dataK</span><span class="err">$</span><span class="n">trans</span> <span class="o">&lt;-</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">dataK</span><span class="err">$</span><span class="n">trans</span><span class="o">/</span><span class="n">pi</span><span class="p">)</span> <span class="o">-</span> <span class="n">dataK</span><span class="err">$</span><span class="n">r</span>
  <span class="n">dataK</span><span class="err">$</span><span class="n">iso</span> <span class="o">&lt;-</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">dataK</span><span class="err">$</span><span class="n">iso</span><span class="o">/</span><span class="n">pi</span><span class="p">)</span> <span class="o">-</span> <span class="n">dataK</span><span class="err">$</span><span class="n">r</span>
  <span class="n">plrange</span> <span class="o">&lt;-</span> <span class="nb">range</span><span class="p">(</span><span class="n">c</span><span class="p">(</span><span class="n">dataK</span><span class="err">$</span><span class="n">border</span><span class="p">[</span><span class="ow">is</span><span class="o">.</span><span class="n">finite</span><span class="p">(</span><span class="n">dataK</span><span class="err">$</span><span class="n">border</span><span class="p">)],</span>
                     <span class="n">dataK</span><span class="err">$</span><span class="n">trans</span><span class="p">[</span><span class="ow">is</span><span class="o">.</span><span class="n">finite</span><span class="p">(</span><span class="n">dataK</span><span class="err">$</span><span class="n">trans</span><span class="p">)],</span>
                     <span class="n">dataK</span><span class="err">$</span><span class="n">iso</span><span class="p">[</span><span class="ow">is</span><span class="o">.</span><span class="n">finite</span><span class="p">(</span><span class="n">dataK</span><span class="err">$</span><span class="n">iso</span><span class="p">)],</span>
                     <span class="n">dataenv</span><span class="err">$</span><span class="n">lo</span><span class="p">[</span><span class="ow">is</span><span class="o">.</span><span class="n">finite</span><span class="p">(</span><span class="n">dataenv</span><span class="err">$</span><span class="n">lo</span><span class="p">)],</span>
                     <span class="n">dataenv</span><span class="err">$</span><span class="n">hi</span><span class="p">[</span><span class="ow">is</span><span class="o">.</span><span class="n">finite</span><span class="p">(</span><span class="n">dataenv</span><span class="err">$</span><span class="n">hi</span><span class="p">)]))</span>
  <span class="n">pllength</span> <span class="o">&lt;-</span> <span class="nb">max</span><span class="p">(</span><span class="n">length</span><span class="p">(</span><span class="n">dataK</span><span class="err">$</span><span class="n">border</span><span class="p">[</span><span class="ow">is</span><span class="o">.</span><span class="n">finite</span><span class="p">(</span><span class="n">dataK</span><span class="err">$</span><span class="n">border</span><span class="p">)]),</span>
                  <span class="n">length</span><span class="p">(</span><span class="n">dataK</span><span class="err">$</span><span class="n">trans</span><span class="p">[</span><span class="ow">is</span><span class="o">.</span><span class="n">finite</span><span class="p">(</span><span class="n">dataK</span><span class="err">$</span><span class="n">trans</span><span class="p">)]),</span>
                  <span class="n">length</span><span class="p">(</span><span class="n">dataK</span><span class="err">$</span><span class="n">iso</span><span class="p">[</span><span class="ow">is</span><span class="o">.</span><span class="n">finite</span><span class="p">(</span><span class="n">dataK</span><span class="err">$</span><span class="n">iso</span><span class="p">)]))</span>
  <span class="n">par</span><span class="p">(</span><span class="n">pty</span> <span class="o">=</span> <span class="s2">&quot;m&quot;</span><span class="p">)</span>
  <span class="n">plot</span><span class="p">(</span><span class="n">dataenv</span><span class="err">$</span><span class="n">r</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="n">pllength</span><span class="p">],</span> <span class="n">dataenv</span><span class="err">$</span><span class="n">obs</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="n">pllength</span><span class="p">],</span> <span class="n">pch</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
       <span class="n">main</span> <span class="o">=</span> <span class="n">paste</span><span class="p">(</span><span class="s2">&quot;L-plot for&quot;</span><span class="p">,</span> <span class="n">datatitle</span><span class="p">),</span> <span class="n">ylim</span> <span class="o">=</span> <span class="n">plrange</span><span class="p">,</span> <span class="n">xlab</span> <span class="o">=</span> <span class="s2">&quot;Distance (h)&quot;</span><span class="p">,</span>
       <span class="n">ylab</span> <span class="o">=</span> <span class="s2">&quot;sqrt(K/pi)-h&quot;</span><span class="p">)</span>
  <span class="n">lines</span><span class="p">(</span><span class="n">dataenv</span><span class="err">$</span><span class="n">r</span><span class="p">,</span> <span class="n">dataenv</span><span class="err">$</span><span class="n">hi</span><span class="p">,</span> <span class="n">lty</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">col</span> <span class="o">=</span> <span class="s2">&quot;Red&quot;</span><span class="p">,</span> <span class="n">lwd</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
  <span class="n">lines</span><span class="p">(</span><span class="n">dataenv</span><span class="err">$</span><span class="n">r</span><span class="p">,</span> <span class="n">dataenv</span><span class="err">$</span><span class="n">lo</span><span class="p">,</span> <span class="n">lty</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">col</span> <span class="o">=</span> <span class="s2">&quot;Red&quot;</span><span class="p">,</span> <span class="n">lwd</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
  <span class="n">lines</span><span class="p">(</span><span class="n">dataK</span><span class="err">$</span><span class="n">r</span><span class="p">,</span> <span class="n">dataK</span><span class="err">$</span><span class="n">theo</span><span class="p">,</span> <span class="n">lty</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">col</span> <span class="o">=</span> <span class="s2">&quot;Black&quot;</span><span class="p">,</span> <span class="n">lwd</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
  <span class="n">lines</span><span class="p">(</span><span class="n">dataK</span><span class="err">$</span><span class="n">r</span><span class="p">,</span> <span class="n">dataK</span><span class="err">$</span><span class="n">border</span><span class="p">,</span> <span class="n">lty</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">col</span> <span class="o">=</span> <span class="s2">&quot;Yellow&quot;</span><span class="p">,</span> <span class="n">lwd</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
  <span class="n">lines</span><span class="p">(</span><span class="n">dataK</span><span class="err">$</span><span class="n">r</span><span class="p">,</span> <span class="n">dataK</span><span class="err">$</span><span class="n">trans</span><span class="p">,</span> <span class="n">lty</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">col</span> <span class="o">=</span> <span class="s2">&quot;Green&quot;</span><span class="p">,</span> <span class="n">lwd</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
  <span class="n">lines</span><span class="p">(</span><span class="n">dataK</span><span class="err">$</span><span class="n">r</span><span class="p">,</span> <span class="n">dataK</span><span class="err">$</span><span class="n">iso</span><span class="p">,</span> <span class="n">lty</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">col</span> <span class="o">=</span> <span class="s2">&quot;Blue&quot;</span><span class="p">,</span> <span class="n">lwd</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
  <span class="n">legend</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">c</span><span class="p">(</span><span class="s2">&quot;CSR&quot;</span><span class="p">,</span> <span class="s2">&quot;Boundaries&quot;</span><span class="p">,</span> <span class="s2">&quot;Border Corrected&quot;</span><span class="p">,</span> <span class="s2">&quot;Trans Corrected&quot;</span><span class="p">,</span> <span class="s2">&quot;Iso Corrected&quot;</span><span class="p">),</span>
         <span class="n">lty</span> <span class="o">=</span> <span class="n">c</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">col</span> <span class="o">=</span> <span class="n">c</span><span class="p">(</span><span class="s2">&quot;Black&quot;</span><span class="p">,</span> <span class="s2">&quot;Red&quot;</span><span class="p">,</span> <span class="s2">&quot;Yellow&quot;</span><span class="p">,</span> <span class="s2">&quot;Green&quot;</span><span class="p">,</span> <span class="s2">&quot;Blue&quot;</span><span class="p">),</span>
         <span class="n">lwd</span> <span class="o">=</span> <span class="n">c</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="n">cex</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">)</span>
<span class="p">}</span>

<span class="c1"># G function</span>
<span class="n">G</span> <span class="o">&lt;-</span> <span class="n">function</span><span class="p">(</span><span class="n">envdata</span><span class="p">,</span> <span class="n">Kdata</span><span class="p">,</span> <span class="n">datatitle</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">dataenv</span> <span class="o">&lt;-</span> <span class="n">envdata</span>
  <span class="n">dataK</span> <span class="o">&lt;-</span> <span class="n">Kdata</span>
  <span class="n">pllength</span> <span class="o">&lt;-</span> <span class="nb">max</span><span class="p">(</span><span class="n">length</span><span class="p">(</span><span class="n">dataK</span><span class="err">$</span><span class="n">rs</span><span class="p">[</span><span class="ow">is</span><span class="o">.</span><span class="n">finite</span><span class="p">(</span><span class="n">dataK</span><span class="err">$</span><span class="n">rs</span><span class="p">)]),</span>
                  <span class="n">length</span><span class="p">(</span><span class="n">dataK</span><span class="err">$</span><span class="n">km</span><span class="p">[</span><span class="ow">is</span><span class="o">.</span><span class="n">finite</span><span class="p">(</span><span class="n">dataK</span><span class="err">$</span><span class="n">km</span><span class="p">)]),</span>
                  <span class="n">length</span><span class="p">(</span><span class="n">dataK</span><span class="err">$</span><span class="n">theo</span><span class="p">[</span><span class="ow">is</span><span class="o">.</span><span class="n">finite</span><span class="p">(</span><span class="n">dataK</span><span class="err">$</span><span class="n">theo</span><span class="p">)]))</span>
  <span class="n">xlim1</span> <span class="o">&lt;-</span> <span class="nb">range</span><span class="p">(</span><span class="n">dataK</span><span class="err">$</span><span class="n">r</span><span class="p">[</span><span class="n">dataK</span><span class="err">$</span><span class="n">km</span><span class="o">&lt;</span><span class="mi">1</span><span class="p">])</span> <span class="o">*</span> <span class="mf">1.25</span>
  <span class="n">xlim2</span> <span class="o">&lt;-</span> <span class="nb">range</span><span class="p">(</span><span class="n">dataK</span><span class="err">$</span><span class="n">r</span><span class="p">[</span><span class="n">dataK</span><span class="err">$</span><span class="n">r</span><span class="o">&lt;</span><span class="mi">1</span><span class="p">])</span> <span class="o">*</span> <span class="mf">1.25</span>
  <span class="n">xlims</span> <span class="o">&lt;-</span> <span class="nb">range</span><span class="p">(</span><span class="n">xlim1</span><span class="p">,</span> <span class="n">xlim2</span><span class="p">)</span>
  <span class="n">par</span><span class="p">(</span><span class="n">pty</span> <span class="o">=</span> <span class="s2">&quot;m&quot;</span><span class="p">)</span>
  <span class="n">plot</span><span class="p">(</span><span class="n">dataenv</span><span class="err">$</span><span class="n">r</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="n">pllength</span><span class="p">],</span> <span class="n">dataenv</span><span class="err">$</span><span class="n">obs</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="n">pllength</span><span class="p">],</span> <span class="n">pch</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
       <span class="n">main</span> <span class="o">=</span> <span class="n">paste</span><span class="p">(</span><span class="s2">&quot;G-plot for&quot;</span><span class="p">,</span> <span class="n">datatitle</span><span class="p">),</span> <span class="n">xlim</span> <span class="o">=</span> <span class="n">xlims</span><span class="p">,</span> <span class="n">ylim</span> <span class="o">=</span> <span class="n">c</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">xlab</span> <span class="o">=</span> <span class="s2">&quot;Distance (r)&quot;</span><span class="p">,</span> <span class="n">ylab</span> <span class="o">=</span> <span class="s2">&quot;G(r)&quot;</span><span class="p">)</span>
  <span class="n">lines</span><span class="p">(</span><span class="n">dataenv</span><span class="err">$</span><span class="n">r</span><span class="p">,</span> <span class="n">dataenv</span><span class="err">$</span><span class="n">hi</span><span class="p">,</span> <span class="n">lty</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">col</span> <span class="o">=</span> <span class="s2">&quot;Red&quot;</span><span class="p">,</span> <span class="n">lwd</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
  <span class="n">lines</span><span class="p">(</span><span class="n">dataenv</span><span class="err">$</span><span class="n">r</span><span class="p">,</span> <span class="n">dataenv</span><span class="err">$</span><span class="n">lo</span><span class="p">,</span> <span class="n">lty</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">col</span> <span class="o">=</span> <span class="s2">&quot;Red&quot;</span><span class="p">,</span> <span class="n">lwd</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
  <span class="n">lines</span><span class="p">(</span><span class="n">dataK</span><span class="err">$</span><span class="n">r</span><span class="p">,</span> <span class="n">dataK</span><span class="err">$</span><span class="n">theo</span><span class="p">,</span> <span class="n">lty</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">col</span> <span class="o">=</span> <span class="s2">&quot;Black&quot;</span><span class="p">,</span> <span class="n">lwd</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
  <span class="n">lines</span><span class="p">(</span><span class="n">dataK</span><span class="err">$</span><span class="n">r</span><span class="p">,</span> <span class="n">dataK</span><span class="err">$</span><span class="n">rs</span><span class="p">,</span> <span class="n">lty</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">col</span> <span class="o">=</span> <span class="s2">&quot;Yellow&quot;</span><span class="p">,</span> <span class="n">lwd</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
  <span class="n">lines</span><span class="p">(</span><span class="n">dataK</span><span class="err">$</span><span class="n">r</span><span class="p">,</span> <span class="n">dataK</span><span class="err">$</span><span class="n">km</span><span class="p">,</span> <span class="n">lty</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">col</span> <span class="o">=</span> <span class="s2">&quot;Green&quot;</span><span class="p">,</span> <span class="n">lwd</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
  <span class="n">lines</span><span class="p">(</span><span class="n">dataK</span><span class="err">$</span><span class="n">r</span><span class="p">,</span> <span class="n">dataK</span><span class="err">$</span><span class="n">han</span><span class="p">,</span> <span class="n">lty</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">col</span> <span class="o">=</span> <span class="s2">&quot;Blue&quot;</span><span class="p">,</span> <span class="n">lwd</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
  <span class="n">legend</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">c</span><span class="p">(</span><span class="s2">&quot;CSR&quot;</span><span class="p">,</span> <span class="s2">&quot;Boundaries&quot;</span><span class="p">,</span> <span class="s2">&quot;Border Corrected&quot;</span><span class="p">,</span> <span class="s2">&quot;KM Corrected&quot;</span><span class="p">,</span> <span class="s2">&quot;Hanish&quot;</span><span class="p">),</span>
         <span class="n">lty</span><span class="o">=</span><span class="n">c</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">col</span> <span class="o">=</span> <span class="n">c</span><span class="p">(</span><span class="s2">&quot;Black&quot;</span><span class="p">,</span> <span class="s2">&quot;Red&quot;</span><span class="p">,</span> <span class="s2">&quot;Yellow&quot;</span><span class="p">,</span> <span class="s2">&quot;Green&quot;</span><span class="p">,</span> <span class="s2">&quot;Blue&quot;</span><span class="p">),</span>
         <span class="n">lwd</span><span class="o">=</span><span class="n">c</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="n">cex</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">)</span>
  <span class="n">par</span><span class="p">(</span><span class="n">pty</span><span class="o">=</span><span class="s2">&quot;s&quot;</span><span class="p">)</span>
<span class="p">}</span>

<span class="c1"># F function</span>
<span class="n">Ffunc</span> <span class="o">&lt;-</span> <span class="n">function</span><span class="p">(</span><span class="n">envdata</span><span class="p">,</span> <span class="n">Kdata</span><span class="p">,</span> <span class="n">datatitle</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">dataenv</span> <span class="o">&lt;-</span> <span class="n">envdata</span>
  <span class="n">dataK</span> <span class="o">&lt;-</span> <span class="n">Kdata</span>
  <span class="n">pllength</span> <span class="o">&lt;-</span> <span class="nb">max</span><span class="p">(</span><span class="n">length</span><span class="p">(</span><span class="n">dataK</span><span class="err">$</span><span class="n">rs</span><span class="p">[</span><span class="ow">is</span><span class="o">.</span><span class="n">finite</span><span class="p">(</span><span class="n">dataK</span><span class="err">$</span><span class="n">rs</span><span class="p">)]),</span>
                  <span class="n">length</span><span class="p">(</span><span class="n">dataK</span><span class="err">$</span><span class="n">km</span><span class="p">[</span><span class="ow">is</span><span class="o">.</span><span class="n">finite</span><span class="p">(</span><span class="n">dataK</span><span class="err">$</span><span class="n">km</span><span class="p">)]),</span>
                  <span class="n">length</span><span class="p">(</span><span class="n">dataK</span><span class="err">$</span><span class="n">theo</span><span class="p">[</span><span class="ow">is</span><span class="o">.</span><span class="n">finite</span><span class="p">(</span><span class="n">dataK</span><span class="err">$</span><span class="n">theo</span><span class="p">)]))</span>
  <span class="n">xlim1</span> <span class="o">&lt;-</span> <span class="nb">range</span><span class="p">(</span><span class="n">dataK</span><span class="err">$</span><span class="n">r</span><span class="p">[</span><span class="n">dataK</span><span class="err">$</span><span class="n">km</span><span class="o">&lt;</span><span class="mi">1</span><span class="p">])</span> <span class="o">*</span> <span class="mf">1.25</span>
  <span class="n">xlim2</span> <span class="o">&lt;-</span> <span class="nb">range</span><span class="p">(</span><span class="n">dataK</span><span class="err">$</span><span class="n">r</span><span class="p">[</span><span class="n">dataK</span><span class="err">$</span><span class="n">r</span><span class="o">&lt;</span><span class="mi">1</span><span class="p">])</span> <span class="o">*</span> <span class="mf">1.25</span>
  <span class="n">xlims</span> <span class="o">&lt;-</span> <span class="nb">range</span><span class="p">(</span><span class="n">xlim1</span><span class="p">,</span> <span class="n">xlim2</span><span class="p">)</span>
  <span class="n">par</span><span class="p">(</span><span class="n">pty</span> <span class="o">=</span> <span class="s2">&quot;m&quot;</span><span class="p">)</span>
  <span class="n">plot</span><span class="p">(</span><span class="n">dataenv</span><span class="err">$</span><span class="n">r</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="n">pllength</span><span class="p">],</span> <span class="n">dataenv</span><span class="err">$</span><span class="n">obs</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="n">pllength</span><span class="p">],</span> <span class="n">pch</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
       <span class="n">main</span><span class="o">=</span><span class="n">paste</span><span class="p">(</span><span class="s2">&quot;F-plot for&quot;</span><span class="p">,</span> <span class="n">datatitle</span><span class="p">),</span> <span class="n">xlim</span> <span class="o">=</span> <span class="n">xlims</span><span class="p">,</span> <span class="n">ylim</span> <span class="o">=</span> <span class="n">c</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">xlab</span> <span class="o">=</span> <span class="s2">&quot;Distance (r)&quot;</span><span class="p">,</span> <span class="n">ylab</span> <span class="o">=</span> <span class="s2">&quot;F(r)&quot;</span><span class="p">)</span>
  <span class="n">lines</span><span class="p">(</span><span class="n">dataenv</span><span class="err">$</span><span class="n">r</span><span class="p">,</span> <span class="n">dataenv</span><span class="err">$</span><span class="n">hi</span><span class="p">,</span> <span class="n">lty</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">col</span> <span class="o">=</span> <span class="s2">&quot;Red&quot;</span><span class="p">,</span> <span class="n">lwd</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
  <span class="n">lines</span><span class="p">(</span><span class="n">dataenv</span><span class="err">$</span><span class="n">r</span><span class="p">,</span> <span class="n">dataenv</span><span class="err">$</span><span class="n">lo</span><span class="p">,</span> <span class="n">lty</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">col</span> <span class="o">=</span> <span class="s2">&quot;Red&quot;</span><span class="p">,</span> <span class="n">lwd</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
  <span class="n">lines</span><span class="p">(</span><span class="n">dataK</span><span class="err">$</span><span class="n">r</span><span class="p">,</span> <span class="n">dataK</span><span class="err">$</span><span class="n">theo</span><span class="p">,</span> <span class="n">lty</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">col</span> <span class="o">=</span> <span class="s2">&quot;Black&quot;</span><span class="p">,</span> <span class="n">lwd</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
  <span class="n">lines</span><span class="p">(</span><span class="n">dataK</span><span class="err">$</span><span class="n">r</span><span class="p">,</span> <span class="n">dataK</span><span class="err">$</span><span class="n">rs</span><span class="p">,</span> <span class="n">lty</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">col</span> <span class="o">=</span> <span class="s2">&quot;Yellow&quot;</span><span class="p">,</span> <span class="n">lwd</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
  <span class="n">lines</span><span class="p">(</span><span class="n">dataK</span><span class="err">$</span><span class="n">r</span><span class="p">,</span> <span class="n">dataK</span><span class="err">$</span><span class="n">km</span><span class="p">,</span> <span class="n">lty</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">col</span> <span class="o">=</span> <span class="s2">&quot;Green&quot;</span><span class="p">,</span> <span class="n">lwd</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
  <span class="n">lines</span><span class="p">(</span><span class="n">dataK</span><span class="err">$</span><span class="n">r</span><span class="p">,</span> <span class="n">dataK</span><span class="err">$</span><span class="n">cs</span><span class="p">,</span> <span class="n">lty</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">col</span> <span class="o">=</span> <span class="s2">&quot;Blue&quot;</span><span class="p">,</span><span class="n">lwd</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
  <span class="n">legend</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">c</span><span class="p">(</span><span class="s2">&quot;CSR&quot;</span><span class="p">,</span> <span class="s2">&quot;Boundaries&quot;</span><span class="p">,</span> <span class="s2">&quot;Border Corrected&quot;</span><span class="p">,</span> <span class="s2">&quot;KM Corrected&quot;</span><span class="p">,</span> <span class="s2">&quot;Chiu-Stoyan&quot;</span><span class="p">),</span>
         <span class="n">lty</span> <span class="o">=</span> <span class="n">c</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">col</span> <span class="o">=</span> <span class="n">c</span><span class="p">(</span><span class="s2">&quot;Black&quot;</span><span class="p">,</span> <span class="s2">&quot;Red&quot;</span><span class="p">,</span> <span class="s2">&quot;Yellow&quot;</span><span class="p">,</span> <span class="s2">&quot;Green&quot;</span><span class="p">,</span> <span class="s2">&quot;Blue&quot;</span><span class="p">),</span>
         <span class="n">lwd</span> <span class="o">=</span> <span class="n">c</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="n">cex</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">)</span>
  <span class="n">par</span><span class="p">(</span><span class="n">pty</span> <span class="o">=</span> <span class="s2">&quot;s&quot;</span><span class="p">)</span>
<span class="p">}</span>

<span class="c1"># J function</span>
<span class="n">Jfunc</span> <span class="o">&lt;-</span> <span class="n">function</span><span class="p">(</span><span class="n">envdata</span><span class="p">,</span> <span class="n">Kdata</span><span class="p">,</span> <span class="n">datatitle</span><span class="p">,</span> <span class="n">xlims</span><span class="p">,</span> <span class="n">ylims</span><span class="p">,</span> <span class="n">legend</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">dataenv</span> <span class="o">&lt;-</span> <span class="n">envdata</span>
  <span class="n">dataK</span> <span class="o">&lt;-</span> <span class="n">Kdata</span>
  <span class="n">pllength</span> <span class="o">&lt;-</span> <span class="nb">max</span><span class="p">(</span><span class="n">length</span><span class="p">(</span><span class="n">dataK</span><span class="err">$</span><span class="n">rs</span><span class="p">[</span><span class="ow">is</span><span class="o">.</span><span class="n">finite</span><span class="p">(</span><span class="n">dataK</span><span class="err">$</span><span class="n">rs</span><span class="p">)]),</span>
                  <span class="n">length</span><span class="p">(</span><span class="n">dataK</span><span class="err">$</span><span class="n">km</span><span class="p">[</span><span class="ow">is</span><span class="o">.</span><span class="n">finite</span><span class="p">(</span><span class="n">dataK</span><span class="err">$</span><span class="n">km</span><span class="p">)]),</span>
                  <span class="n">length</span><span class="p">(</span><span class="n">dataK</span><span class="err">$</span><span class="n">theo</span><span class="p">[</span><span class="ow">is</span><span class="o">.</span><span class="n">finite</span><span class="p">(</span><span class="n">dataK</span><span class="err">$</span><span class="n">theo</span><span class="p">)]))</span>
  <span class="n">par</span><span class="p">(</span><span class="n">pty</span> <span class="o">=</span> <span class="s2">&quot;m&quot;</span><span class="p">)</span>
  <span class="n">plot</span><span class="p">(</span><span class="n">dataenv</span><span class="err">$</span><span class="n">r</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="n">pllength</span><span class="p">],</span> <span class="n">dataenv</span><span class="err">$</span><span class="n">obs</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="n">pllength</span><span class="p">],</span> <span class="n">pch</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
       <span class="n">main</span> <span class="o">=</span> <span class="n">paste</span><span class="p">(</span><span class="s2">&quot;J-plot for&quot;</span><span class="p">,</span> <span class="n">datatitle</span><span class="p">),</span> <span class="n">xlim</span> <span class="o">=</span> <span class="n">xlims</span><span class="p">,</span> <span class="n">ylim</span> <span class="o">=</span> <span class="n">ylims</span><span class="p">,</span> <span class="n">xlab</span> <span class="o">=</span> <span class="s2">&quot;Distance (r)&quot;</span><span class="p">,</span> <span class="n">ylab</span> <span class="o">=</span> <span class="s2">&quot;J(r)&quot;</span><span class="p">)</span>
  <span class="n">lines</span><span class="p">(</span><span class="n">dataenv</span><span class="err">$</span><span class="n">r</span><span class="p">,</span> <span class="n">dataenv</span><span class="err">$</span><span class="n">hi</span><span class="p">,</span> <span class="n">lty</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">col</span> <span class="o">=</span> <span class="s2">&quot;Red&quot;</span><span class="p">,</span> <span class="n">lwd</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
  <span class="n">lines</span><span class="p">(</span><span class="n">dataenv</span><span class="err">$</span><span class="n">r</span><span class="p">,</span> <span class="n">dataenv</span><span class="err">$</span><span class="n">lo</span><span class="p">,</span> <span class="n">lty</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">col</span> <span class="o">=</span> <span class="s2">&quot;Red&quot;</span><span class="p">,</span> <span class="n">lwd</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
  <span class="n">lines</span><span class="p">(</span><span class="n">dataK</span><span class="err">$</span><span class="n">r</span><span class="p">,</span> <span class="n">dataK</span><span class="err">$</span><span class="n">theo</span><span class="p">,</span> <span class="n">lty</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">col</span> <span class="o">=</span> <span class="s2">&quot;Black&quot;</span><span class="p">,</span> <span class="n">lwd</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
  <span class="n">lines</span><span class="p">(</span><span class="n">dataK</span><span class="err">$</span><span class="n">r</span><span class="p">,</span> <span class="n">dataK</span><span class="err">$</span><span class="n">rs</span><span class="p">,</span> <span class="n">lty</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">col</span> <span class="o">=</span> <span class="s2">&quot;Yellow&quot;</span><span class="p">,</span> <span class="n">lwd</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
  <span class="n">lines</span><span class="p">(</span><span class="n">dataK</span><span class="err">$</span><span class="n">r</span><span class="p">,</span> <span class="n">dataK</span><span class="err">$</span><span class="n">km</span><span class="p">,</span> <span class="n">lty</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">col</span> <span class="o">=</span> <span class="s2">&quot;Green&quot;</span><span class="p">,</span> <span class="n">lwd</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
  <span class="n">lines</span><span class="p">(</span><span class="n">dataK</span><span class="err">$</span><span class="n">r</span><span class="p">,</span> <span class="n">dataK</span><span class="err">$</span><span class="n">han</span><span class="p">,</span> <span class="n">lty</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">col</span> <span class="o">=</span> <span class="s2">&quot;Blue&quot;</span><span class="p">,</span> <span class="n">lwd</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
  <span class="n">legend</span><span class="p">(</span><span class="n">legend</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">legend</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">c</span><span class="p">(</span><span class="s2">&quot;CSR&quot;</span><span class="p">,</span> <span class="s2">&quot;Boundaries&quot;</span><span class="p">,</span> <span class="s2">&quot;Border Corrected&quot;</span><span class="p">,</span> <span class="s2">&quot;KM Corrected&quot;</span><span class="p">,</span> <span class="s2">&quot;Hanish Corrected&quot;</span><span class="p">),</span>
         <span class="n">lty</span> <span class="o">=</span> <span class="n">c</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">col</span> <span class="o">=</span> <span class="n">c</span><span class="p">(</span><span class="s2">&quot;Black&quot;</span><span class="p">,</span> <span class="s2">&quot;Red&quot;</span><span class="p">,</span> <span class="s2">&quot;Yellow&quot;</span><span class="p">,</span> <span class="s2">&quot;Green&quot;</span><span class="p">,</span> <span class="s2">&quot;Blue&quot;</span><span class="p">),</span>
         <span class="n">lwd</span> <span class="o">=</span> <span class="n">c</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="n">cex</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">)</span>
  <span class="n">par</span><span class="p">(</span><span class="n">pty</span> <span class="o">=</span> <span class="s2">&quot;s&quot;</span><span class="p">)</span>
<span class="p">}</span>

<span class="c1"># Plot K, L, G, F, J functions</span>
<span class="n">wf</span><span class="o">.</span><span class="n">env</span> <span class="o">&lt;-</span> <span class="n">envelope</span><span class="p">(</span><span class="n">wfppp</span><span class="p">,</span> <span class="n">fun</span> <span class="o">=</span> <span class="n">Kest</span><span class="p">)</span>
<span class="n">wf</span><span class="o">.</span><span class="n">K</span> <span class="o">&lt;-</span> <span class="n">Kest</span><span class="p">(</span><span class="n">wfppp</span><span class="p">)</span>
<span class="n">Kplot</span><span class="p">(</span><span class="n">wf</span><span class="o">.</span><span class="n">env</span><span class="p">,</span> <span class="n">wf</span><span class="o">.</span><span class="n">K</span><span class="p">,</span> <span class="n">datatitle</span> <span class="o">=</span> <span class="s2">&quot;Wi-Fi Locations&quot;</span><span class="p">)</span>
<span class="n">L</span><span class="p">(</span><span class="n">wf</span><span class="o">.</span><span class="n">env</span><span class="p">,</span> <span class="n">wf</span><span class="o">.</span><span class="n">K</span><span class="p">,</span> <span class="n">datatitle</span> <span class="o">=</span> <span class="s2">&quot;Wi-Fi Locations&quot;</span><span class="p">)</span>

<span class="n">wf</span><span class="o">.</span><span class="n">env</span> <span class="o">&lt;-</span> <span class="n">envelope</span><span class="p">(</span><span class="n">wfppp</span><span class="p">,</span> <span class="n">fun</span> <span class="o">=</span> <span class="n">Gest</span><span class="p">)</span>
<span class="n">wf</span><span class="o">.</span><span class="n">G</span> <span class="o">&lt;-</span> <span class="n">Gest</span><span class="p">(</span><span class="n">wfppp</span><span class="p">)</span>
<span class="n">G</span><span class="p">(</span><span class="n">wf</span><span class="o">.</span><span class="n">env</span><span class="p">,</span> <span class="n">wf</span><span class="o">.</span><span class="n">G</span><span class="p">,</span> <span class="s2">&quot;G&quot;</span><span class="p">)</span>

<span class="n">wf</span><span class="o">.</span><span class="n">env</span> <span class="o">&lt;-</span> <span class="n">envelope</span><span class="p">(</span><span class="n">wfppp</span><span class="p">,</span> <span class="n">fun</span> <span class="o">=</span> <span class="n">Fest</span><span class="p">)</span>
<span class="n">wf</span><span class="o">.</span><span class="n">F</span> <span class="o">&lt;-</span> <span class="n">Fest</span><span class="p">(</span><span class="n">wfppp</span><span class="p">)</span>
<span class="n">Ffunc</span><span class="p">(</span><span class="n">wf</span><span class="o">.</span><span class="n">env</span><span class="p">,</span> <span class="n">wf</span><span class="o">.</span><span class="n">F</span><span class="p">,</span> <span class="s2">&quot;F&quot;</span><span class="p">)</span>

<span class="n">wf</span><span class="o">.</span><span class="n">env</span> <span class="o">&lt;-</span> <span class="n">envelope</span><span class="p">(</span><span class="n">wfppp</span><span class="p">,</span> <span class="n">fun</span> <span class="o">=</span> <span class="n">Jest</span><span class="p">)</span>
<span class="n">wf</span><span class="o">.</span><span class="n">J</span> <span class="o">&lt;-</span> <span class="n">Jest</span><span class="p">(</span><span class="n">wfppp</span><span class="p">)</span>
<span class="n">Jfunc</span><span class="p">(</span><span class="n">wf</span><span class="o">.</span><span class="n">env</span><span class="p">,</span> <span class="n">wf</span><span class="o">.</span><span class="n">J</span><span class="p">,</span> <span class="n">xlims</span> <span class="o">=</span> <span class="n">c</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">),</span> <span class="n">ylims</span> <span class="o">=</span> <span class="n">c</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="n">datatitle</span> <span class="o">=</span> <span class="s2">&quot;J&quot;</span><span class="p">)</span>
</pre></div>


<p><img alt="wifikl" src="https://stathwang.github.io/images/wifikl.png"></p>
<p>From the <span class="math">\(K\)</span> and the <span class="math">\(L\)</span> plots, all the colored lines are well above the black and the dotted ones, which represents the CSR baseline, so the points are indeed clustered. Different color corresponds to different border correction methods. Plots of other functions <span class="math">\(G\)</span>, <span class="math">\(F\)</span>, and <span class="math">\(J\)</span> (not shown) also indicate a clustered process.</p>
<h3>Marked Point Process</h3>
<p>Since each spatial point is marked by two factors: WiFi network providers and WiFi location types, we have a <strong>marked point process</strong>. Each point has an associated attribute which could be categorical (species, disease status), or continuous (diameter). We can examine relationships between a particular group and all other groups i.e. multi-group comparison.</p>
<p>Here we observe that KT WiFi locations are mainly concentrated near the north of the river, while SKTs are concentrated near the south of the river. LGU+ covers a wider range around the center of Seoul.</p>
<p><img alt="w11" src="https://stathwang.github.io/images/WiFi-Locations-Part.png">
<img alt="w12" src="https://stathwang.github.io/images/WiFi-Locations-Part2.png"></p>
<div class="highlight"><pre><span></span><span class="n">q1</span> <span class="o">&lt;-</span> <span class="n">seoul_map</span> <span class="o">+</span> 
  <span class="n">geom_points</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">wifi</span><span class="p">,</span>
              <span class="n">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">lng</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">lat</span><span class="p">))</span>
<span class="n">q2</span> <span class="o">&lt;-</span> <span class="n">seoul_map</span> <span class="o">+</span>
  <span class="n">geom_polygon</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">wifi</span><span class="p">,</span> 
               <span class="n">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">lng</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">lat</span><span class="p">,</span> <span class="n">fill</span> <span class="o">=</span> <span class="o">..</span><span class="n">level</span><span class="o">..</span><span class="p">),</span>
               <span class="n">stat</span> <span class="o">=</span> <span class="s1">&#39;density2d&#39;</span><span class="p">,</span>
               <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">)</span> <span class="o">+</span>
  <span class="n">facet_wrap</span><span class="p">(</span><span class="o">~</span><span class="n">comp</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">q1</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">q2</span><span class="p">)</span>
</pre></div>


<p>Plotting the points by location types, we observe that KT WiFis are exclusively near bus stops, while SKT and LGU+ dominate near main streets and parks. Note that the red dots refer to KT locations, greens LGU+s, and blue dots SKTs.</p>
<p><img alt="wifitypes" src="https://stathwang.github.io/images/wifitypes.png"></p>
<div class="highlight"><pre><span></span><span class="n">q3</span> <span class="o">&lt;-</span> <span class="n">seoul_map</span> <span class="o">+</span> 
  <span class="n">geom_point</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">wifi</span><span class="p">,</span> <span class="n">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">lng</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">lat</span><span class="p">,</span> <span class="n">colour</span> <span class="o">=</span> <span class="n">comp</span><span class="p">))</span> <span class="o">+</span> 
  <span class="n">facet_wrap</span><span class="p">(</span><span class="o">~</span><span class="n">cat</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">q3</span><span class="p">)</span>
</pre></div>


<p>The point process of free public WiFi locations in Seoul is actually a combination of points in several groups. Each point is marked - that is, we have a <strong>marked point process</strong>. There are two marks: WiFi network providers with 3 levels: <em>KT</em>, <em>SKT</em>, and <em>LGU+</em>, and WiFi location types with 12 levels. In a multiple point process, we can compare density estimates as well as plot multi-group versions of the <span class="math">\(K\)</span>, <span class="math">\(L\)</span>, <span class="math">\(G\)</span>, <span class="math">\(F\)</span>, and <span class="math">\(J\)</span> functions. </p>
<div class="highlight"><pre><span></span><span class="c1"># Marked point process</span>
<span class="n">wfact</span> <span class="o">&lt;-</span> <span class="k">as</span><span class="o">.</span><span class="n">factor</span><span class="p">(</span><span class="n">wifi</span><span class="err">$</span><span class="n">comp</span><span class="p">)</span>
<span class="n">wfdot</span><span class="o">.</span><span class="n">ppp</span> <span class="o">&lt;-</span> <span class="n">ppp</span><span class="p">(</span><span class="n">wifi</span><span class="o">.</span><span class="n">pts</span><span class="p">[,</span><span class="mi">1</span><span class="p">],</span> <span class="n">wifi</span><span class="o">.</span><span class="n">pts</span><span class="p">[,</span><span class="mi">2</span><span class="p">],</span> 
                 <span class="nb">xrange</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">wifi</span><span class="o">.</span><span class="n">poly</span><span class="p">[,</span><span class="mi">1</span><span class="p">]),</span>
                 <span class="n">yrange</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">wifi</span><span class="o">.</span><span class="n">poly</span><span class="p">[,</span><span class="mi">2</span><span class="p">]),</span>
                 <span class="n">marks</span> <span class="o">=</span> <span class="n">wfact</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">split</span><span class="p">(</span><span class="n">wfdot</span><span class="o">.</span><span class="n">ppp</span><span class="p">),</span> <span class="n">chars</span> <span class="o">=</span> <span class="mi">16</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">density</span><span class="p">(</span><span class="n">split</span><span class="p">(</span><span class="n">wfdot</span><span class="o">.</span><span class="n">ppp</span><span class="p">)),</span> <span class="n">chars</span> <span class="o">=</span> <span class="n">c</span><span class="p">(</span><span class="mi">16</span><span class="p">:</span><span class="mi">18</span><span class="p">),</span> <span class="n">ribbon</span> <span class="o">=</span> <span class="n">FALSE</span><span class="p">)</span>
</pre></div>


<p>For many point processes, CSR is not the appropriate null hypothesis. Events will appear to be not CSR simply because the events follow a heterogenous Poisson point process that mirrors, say, population. For instance, disease or crime events will simply follow the population distribution or multiple tree species simply group by more favorable soil or climate conditions.</p>
<p>In this case, we need to correct for the underlying intensity function. The basic idea is to compare the intensity function of <code>cases</code> to that of a chosen baseline of <code>control</code>. This comparison is done by computing a kernel intensity estimate for each group over the same region <span class="math">\(R\)</span>. A ratio of estimates is then calculated and plotted. This method requires that the intensity functions be normalized to have total area under the curve equal to 1. That is, we use density functions instead of intensity functions in the ratio. The ratio of density estimates, or so called <strong>relative risk</strong>, is expressed as relative probabilities rather than relative intensities, but the interpretation is similar.</p>
<div class="highlight"><pre><span></span><span class="c1"># Relative risk</span>
<span class="n">mainerr</span> <span class="o">&lt;-</span> <span class="n">relrisk</span><span class="p">(</span><span class="n">wfdot</span><span class="o">.</span><span class="n">ppp</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">mainerr</span><span class="p">,</span> <span class="n">main</span> <span class="o">=</span> <span class="s2">&quot;Relative Risk by WiFi Network Providers&quot;</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">im</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">mainerr</span><span class="p">,</span> <span class="n">which</span><span class="o">.</span><span class="n">max</span><span class="p">),</span> <span class="n">main</span> <span class="o">=</span> <span class="s2">&quot;Most Common WiFi Network Providers&quot;</span><span class="p">)</span>
</pre></div>


<p><img alt="relrisk" src="https://stathwang.github.io/images/relrisk.png"></p>
<p>For KT, the density is higher near the upper outskirts of Seoul, whereas the density for LGU+ is concentrated near the center and SKT near the lower right.</p>
<p>Plot multi-group versions of the <span class="math">\(K\)</span>, <span class="math">\(L\)</span>, and <span class="math">\(G\)</span> functions. Each function makes a one-to-many comparison. As an example, the R code below sets the baseline control to be LGU+. The points are clustered as well even when compared to a different baseline than CSR.</p>
<div class="highlight"><pre><span></span><span class="c1"># Plot Gdot, Kdot, and Ldot from one to many</span>
<span class="n">par</span><span class="p">(</span><span class="n">mfrow</span> <span class="o">=</span> <span class="n">c</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="n">plot</span><span class="p">(</span><span class="n">Gdot</span><span class="p">(</span><span class="n">wfdot</span><span class="o">.</span><span class="n">ppp</span><span class="p">,</span> <span class="s2">&quot;LGU+&quot;</span><span class="p">),</span> <span class="n">lwd</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="n">main</span> <span class="o">=</span> <span class="s2">&quot;Gdot Ref. LGU+&quot;</span><span class="p">)</span>
<span class="n">env</span> <span class="o">&lt;-</span> <span class="n">envelope</span><span class="p">(</span><span class="n">wfdot</span><span class="o">.</span><span class="n">ppp</span><span class="p">,</span> <span class="n">fun</span> <span class="o">=</span> <span class="n">Gdot</span><span class="p">,</span> <span class="n">i</span> <span class="o">=</span> <span class="s2">&quot;LGU+&quot;</span><span class="p">,</span> <span class="n">nsim</span> <span class="o">=</span> <span class="mi">99</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="n">add</span> <span class="o">=</span> <span class="n">TRUE</span><span class="p">)</span>

<span class="n">plot</span><span class="p">(</span><span class="n">Kdot</span><span class="p">(</span><span class="n">wfdot</span><span class="o">.</span><span class="n">ppp</span><span class="p">,</span> <span class="s2">&quot;LGU+&quot;</span><span class="p">),</span> <span class="n">lwd</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="n">main</span> <span class="o">=</span> <span class="s2">&quot;Kdot Ref. LGU+&quot;</span><span class="p">)</span>
<span class="n">env</span> <span class="o">&lt;-</span> <span class="n">envelope</span><span class="p">(</span><span class="n">wfdot</span><span class="o">.</span><span class="n">ppp</span><span class="p">,</span> <span class="n">fun</span> <span class="o">=</span> <span class="n">Kdot</span><span class="p">,</span> <span class="n">i</span> <span class="o">=</span> <span class="s2">&quot;LGU+&quot;</span><span class="p">,</span> <span class="n">nsim</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="n">add</span> <span class="o">=</span> <span class="n">TRUE</span><span class="p">)</span>

<span class="n">plot</span><span class="p">(</span><span class="n">Ldot</span><span class="p">(</span><span class="n">wfdot</span><span class="o">.</span><span class="n">ppp</span><span class="p">,</span> <span class="s2">&quot;LGU+&quot;</span><span class="p">),</span> <span class="n">lwd</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="n">main</span> <span class="o">=</span> <span class="s2">&quot;Ldot Ref. LGU+&quot;</span><span class="p">)</span>
<span class="n">env</span> <span class="o">&lt;-</span> <span class="n">envelope</span><span class="p">(</span><span class="n">wfdot</span><span class="o">.</span><span class="n">ppp</span><span class="p">,</span> <span class="n">fun</span> <span class="o">=</span> <span class="n">Ldot</span><span class="p">,</span> <span class="n">i</span> <span class="o">=</span> <span class="s2">&quot;LGU+&quot;</span><span class="p">,</span> <span class="n">nsim</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="n">add</span> <span class="o">=</span> <span class="n">TRUE</span><span class="p">)</span>
</pre></div>


<p><img alt="wifidots" src="https://stathwang.github.io/images/wifidots.png"></p>
<h3>Foursquare Data</h3>
<p>My hypothesis is there may be a correlation between the popularity of the area near the location of a free public WiFi in Seoul and the location itself. The more popular the area, the higher the chance of seeing a free public WiFi. Otherwise, what's the point of setting up one if no one will use it?</p>
<p>How should we define the metric of popularity? Where do we get the data? Foursquare is a location-based social network that has gathered a wealth of location and foot traffic data from its users. I'm going to retrieve the data on places within a predefined region of each WiFi location and roughly estimate the popularity as the total number of checkins, users, and tips. The more often Foursquare users check into a place, the more likely there may be a free public WiFi nearby.</p>
<p>First, get your own client ID and client secret from the <a href="https://developer.foursquare.com">Foursquare API</a> page by signing up. Then, for every free public WiFi location coordinate - that is, for every pair of latitude and longitude of our data <code>wifi</code> from above, grab up to 50 different locations (latitude and longitude) within the radius of 400m and their business names, business categories, total number of checkins, total number of users, and total number of tips. <em>Iterate until no additional locations are returned.</em> By doing this, we are basically getting the popularity of every possible place in Seoul. Refer to my R code below.</p>
<div class="highlight"><pre><span></span><span class="n">client_id</span> <span class="o">&lt;-</span> <span class="s2">&quot;USE_YOUR_OWN_CLIENT_ID&quot;</span>
<span class="n">client_secret</span> <span class="o">&lt;-</span> <span class="s2">&quot;USE_YOUR_OWN_CLIENT_SECRET&quot;</span>

<span class="n">starttime</span> <span class="o">&lt;-</span> <span class="n">Sys</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">dat</span> <span class="o">&lt;-</span> <span class="n">llply</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nrow</span><span class="p">(</span><span class="n">wifi</span><span class="p">),</span> <span class="n">function</span><span class="p">(</span><span class="n">r</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">lats</span> <span class="o">&lt;-</span> <span class="n">wifi</span><span class="err">$</span><span class="n">lat</span>
  <span class="n">lngs</span> <span class="o">&lt;-</span> <span class="n">wifi</span><span class="err">$</span><span class="n">lng</span>
  <span class="n">lat</span> <span class="o">&lt;-</span> <span class="k">as</span><span class="o">.</span><span class="n">numeric</span><span class="p">(</span><span class="n">lats</span><span class="p">[</span><span class="n">r</span><span class="p">])</span>
  <span class="n">lng</span> <span class="o">&lt;-</span> <span class="k">as</span><span class="o">.</span><span class="n">numeric</span><span class="p">(</span><span class="n">lngs</span><span class="p">[</span><span class="n">r</span><span class="p">])</span>
  <span class="n">ll</span> <span class="o">&lt;-</span> <span class="n">paste0</span><span class="p">(</span><span class="n">lat</span><span class="p">,</span> <span class="s2">&quot;,&quot;</span><span class="p">,</span> <span class="n">lng</span><span class="p">)</span>
  <span class="n">url</span> <span class="o">&lt;-</span> <span class="n">paste0</span><span class="p">(</span><span class="s2">&quot;https://api.foursquare.com/v2/venues/search?ll=&quot;</span><span class="p">,</span> <span class="n">ll</span><span class="p">,</span> <span class="s2">&quot;&amp;radius=&quot;</span><span class="p">,</span> <span class="mi">400</span><span class="p">,</span>
                <span class="s2">&quot;&amp;client_id=&quot;</span><span class="p">,</span> <span class="n">client_id</span><span class="p">,</span> <span class="s2">&quot;&amp;client_secret=&quot;</span><span class="p">,</span> <span class="n">client_secret</span><span class="p">,</span> 
                <span class="s2">&quot;&amp;limit=50&amp;intent=browse&amp;v=20160101&amp;m=foursquare&quot;</span><span class="p">)</span>
  <span class="n">output</span> <span class="o">&lt;-</span> <span class="n">getURL</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
  <span class="n">vdata</span> <span class="o">&lt;-</span> <span class="n">fromJSON</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
  <span class="n">vv</span> <span class="o">&lt;-</span> <span class="n">vdata</span><span class="err">$</span><span class="n">response</span><span class="err">$</span><span class="n">venues</span>
  <span class="n">n</span> <span class="o">&lt;-</span> <span class="n">length</span><span class="p">(</span><span class="n">vv</span><span class="p">)</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">n</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">grp</span> <span class="o">&lt;-</span> <span class="n">llply</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">n</span><span class="p">,</span> <span class="n">function</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">name</span> <span class="o">&lt;-</span> <span class="n">vv</span><span class="p">[[</span><span class="n">i</span><span class="p">]]</span><span class="err">$</span><span class="n">name</span>
      <span class="n">lat</span> <span class="o">&lt;-</span> <span class="n">vv</span><span class="p">[[</span><span class="n">i</span><span class="p">]]</span><span class="err">$</span><span class="n">location</span><span class="err">$</span><span class="n">lat</span>
      <span class="n">lng</span> <span class="o">&lt;-</span> <span class="n">vv</span><span class="p">[[</span><span class="n">i</span><span class="p">]]</span><span class="err">$</span><span class="n">location</span><span class="err">$</span><span class="n">lng</span>
      <span class="n">cat</span> <span class="o">&lt;-</span> <span class="n">ifelse</span><span class="p">(</span><span class="n">length</span><span class="p">(</span><span class="n">vv</span><span class="p">[[</span><span class="n">i</span><span class="p">]]</span><span class="err">$</span><span class="n">categories</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="n">vv</span><span class="p">[[</span><span class="n">i</span><span class="p">]]</span><span class="err">$</span><span class="n">categories</span><span class="p">[[</span><span class="mi">1</span><span class="p">]]</span><span class="err">$</span><span class="n">name</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">length</span><span class="p">(</span><span class="n">vv</span><span class="p">[[</span><span class="n">i</span><span class="p">]]</span><span class="err">$</span><span class="n">stats</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">checkins</span> <span class="o">&lt;-</span> <span class="n">vv</span><span class="p">[[</span><span class="n">i</span><span class="p">]]</span><span class="err">$</span><span class="n">stats</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">users</span> <span class="o">&lt;-</span> <span class="n">vv</span><span class="p">[[</span><span class="n">i</span><span class="p">]]</span><span class="err">$</span><span class="n">stats</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">tips</span> <span class="o">&lt;-</span> <span class="n">vv</span><span class="p">[[</span><span class="n">i</span><span class="p">]]</span><span class="err">$</span><span class="n">stats</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="n">chckins</span> <span class="o">=</span> <span class="n">users</span> <span class="o">=</span> <span class="n">tips</span> <span class="o">=</span> <span class="mi">0</span>
      <span class="p">}</span>
      <span class="k">return</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">table</span><span class="p">(</span><span class="n">cbind</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="n">lng</span><span class="p">,</span> <span class="n">cat</span><span class="p">,</span> <span class="n">checkins</span><span class="p">,</span> <span class="n">users</span><span class="p">,</span> <span class="n">tips</span><span class="p">)))</span>
    <span class="p">},</span> <span class="o">.</span><span class="n">parallel</span> <span class="o">=</span> <span class="n">FALSE</span><span class="p">)</span>
    <span class="n">temp</span> <span class="o">&lt;-</span> <span class="n">rbindlist</span><span class="p">(</span><span class="n">grp</span><span class="p">)</span>
    <span class="k">return</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
  <span class="p">}</span>
  <span class="n">cat</span><span class="p">(</span><span class="s1">&#39;Done with&#39;</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">r</span><span class="o">/</span><span class="n">nrow</span><span class="p">(</span><span class="n">wifi</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="s1">&#39;%</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="p">},</span> <span class="o">.</span><span class="n">parallel</span> <span class="o">=</span> <span class="n">FALSE</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">Sys</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">starttime</span><span class="p">)</span>

<span class="n">dt</span> <span class="o">&lt;-</span> <span class="n">rbindlist</span><span class="p">(</span><span class="n">dat</span><span class="p">)</span>
<span class="n">fwrite</span><span class="p">(</span><span class="n">dt</span><span class="p">,</span> <span class="nb">file</span> <span class="o">=</span> <span class="s2">&quot;fsq-locations.csv&quot;</span><span class="p">)</span>
</pre></div>


<h3>Point Process Models</h3>
<p>Fit <strong>point process models</strong> (PPM) with a mark. <code>dq</code> is the final output after all necessary iterations of the code above. The mark here is the factor variable WiFi network providers with 3 levels. Though we can set the mark to be the factor variable location types, the number of levels is 12 and the model runs pretty slow with that many levels. Note that <code>ppm</code> function doesn't allow data to have more than one mark, so if we want to use both factors in this case, then we would need to multiply them and set the new mark to be a single factor variable with <span class="math">\(12 \times 3 = 36\)</span> levels.</p>
<p>After model fitting, we use the stepwise variable selection to arrive at our final model <code>ppm(quadscheme(wfdot.ppp) ~ poly(x,y,2) + checkins, data = dq)</code> with no marks included. The model has the lowest AIC (-45418.85).</p>
<div class="highlight"><pre><span></span><span class="c1"># Add a mark to a ppp object</span>
<span class="n">wfact</span> <span class="o">&lt;-</span> <span class="k">as</span><span class="o">.</span><span class="n">factor</span><span class="p">(</span><span class="n">wifi</span><span class="err">$</span><span class="n">comp</span><span class="p">)</span>
<span class="n">wfdot</span><span class="o">.</span><span class="n">ppp</span> <span class="o">&lt;-</span> <span class="n">ppp</span><span class="p">(</span><span class="n">wifi</span><span class="o">.</span><span class="n">pts</span><span class="p">[,</span><span class="mi">1</span><span class="p">],</span> <span class="n">wifi</span><span class="o">.</span><span class="n">pts</span><span class="p">[,</span><span class="mi">2</span><span class="p">],</span> 
                 <span class="nb">xrange</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">wifi</span><span class="o">.</span><span class="n">poly</span><span class="p">[,</span><span class="mi">1</span><span class="p">]),</span>
                 <span class="n">yrange</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">wifi</span><span class="o">.</span><span class="n">poly</span><span class="p">[,</span><span class="mi">2</span><span class="p">]),</span>
                 <span class="n">marks</span> <span class="o">=</span> <span class="n">wfact</span><span class="p">)</span>
<span class="n">P</span> <span class="o">&lt;-</span> <span class="n">quadscheme</span><span class="p">(</span><span class="n">wfppp</span><span class="p">)</span>
<span class="n">Q</span> <span class="o">&lt;-</span> <span class="n">quadscheme</span><span class="p">(</span><span class="n">wfdot</span><span class="o">.</span><span class="n">ppp</span><span class="p">)</span>
<span class="n">pp</span><span class="o">.</span><span class="n">null</span> <span class="o">&lt;-</span> <span class="n">ppm</span><span class="p">(</span><span class="n">P</span> <span class="o">~</span> <span class="mi">1</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">dq</span><span class="p">)</span>
<span class="n">pp</span><span class="o">.</span><span class="n">full1</span> <span class="o">&lt;-</span> <span class="n">ppm</span><span class="p">(</span><span class="n">P</span> <span class="o">~</span> <span class="n">polynom</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">checkins</span> <span class="o">+</span> <span class="n">users</span> <span class="o">+</span> <span class="n">tips</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">dq</span><span class="p">)</span>
<span class="n">pp</span><span class="o">.</span><span class="n">full2</span> <span class="o">&lt;-</span> <span class="n">ppm</span><span class="p">(</span><span class="n">Q</span> <span class="o">~</span> <span class="n">polynom</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">marks</span> <span class="o">+</span> <span class="n">checkins</span> <span class="o">+</span> <span class="n">users</span> <span class="o">+</span> <span class="n">tips</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">dq</span><span class="p">)</span>

<span class="c1"># Analysis of deviance</span>
<span class="n">anova</span><span class="p">(</span><span class="n">pp</span><span class="o">.</span><span class="n">null</span><span class="p">,</span> <span class="n">pp</span><span class="o">.</span><span class="n">full1</span><span class="p">,</span> <span class="n">test</span> <span class="o">=</span> <span class="s2">&quot;LRT&quot;</span><span class="p">)</span>

<span class="c1"># Stepwise variable selection</span>
<span class="n">AIC</span><span class="p">(</span><span class="n">pp</span><span class="o">.</span><span class="n">null</span><span class="p">);</span> <span class="n">AIC</span><span class="p">(</span><span class="n">pp</span><span class="o">.</span><span class="n">full1</span><span class="p">);</span> <span class="n">AIC</span><span class="p">(</span><span class="n">pp</span><span class="o">.</span><span class="n">full2</span><span class="p">)</span>
<span class="n">pp</span><span class="o">.</span><span class="n">step</span> <span class="o">&lt;-</span> <span class="n">step</span><span class="p">(</span><span class="n">pp</span><span class="o">.</span><span class="n">full1</span><span class="p">)</span>
<span class="n">AIC</span><span class="p">(</span><span class="n">pp</span><span class="o">.</span><span class="n">step</span><span class="p">)</span>

<span class="c1"># Diagnostic plots</span>
<span class="n">diagnose</span><span class="o">.</span><span class="n">ppm</span><span class="p">(</span><span class="n">pp</span><span class="o">.</span><span class="n">null</span><span class="p">)</span>
<span class="n">diagnose</span><span class="o">.</span><span class="n">ppm</span><span class="p">(</span><span class="n">pp</span><span class="o">.</span><span class="n">step</span><span class="p">)</span>
</pre></div>


<p><img alt="wifidiagnostics" src="{attach}images/wifidiagnostics.png"></p>
<p>The diagnostic plot of the null model with no predictors looks awful, while that of the final model looks good. The sky blue "valley" we see on the lower right corner may refer to the Han river that goes through the center of Seoul which doesn't have any buildings or free public WiFis.</p>
<h3>Conclusions</h3>
<ol>
<li>
<p>Free public WiFi locations are clustered. How they are clustered is different across WiFi network providers and location types.</p>
</li>
<li>
<p>Foursquare checkins data are quite useful.</p>
</li>
<li>
<p>The best model is <code>ppm(quadscheme(wf.ppp) ~ polynom(x,y,2) + checkins, data = dq)</code> with no marks.</p>
</li>
</ol>
<script type="text/javascript">if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var align = "center",
        indent = "0em",
        linebreak = "false";

    if (false) {
        align = (screen.width < 768) ? "left" : align;
        indent = (screen.width < 768) ? "0em" : indent;
        linebreak = (screen.width < 768) ? 'true' : linebreak;
    }

    var mathjaxscript = document.createElement('script');
    var location_protocol = (false) ? 'https' : document.location.protocol;
    if (location_protocol !== 'http' && location_protocol !== 'https') location_protocol = 'https:';
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = location_protocol + '//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: '"+ align +"'," +
        "    displayIndent: '"+ indent +"'," +
        "    showMathMenu: true," +
        "    messageStyle: 'normal'," +
        "    tex2jax: { " +
        "        inlineMath: [ ['\\\\(','\\\\)'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'inherit ! important'} }," +
        "        linebreaks: { automatic: "+ linebreak +", width: '90% container' }," +
        "    }, " +
        "}); " +
        "if ('default' !== 'default') {" +
            "MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
            "MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
        "}";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
</script>
  </div>
  <div class="tag-cloud">
    <p>
      <a href="https://stathwang.github.io/tag/point-process-models.html">point process models</a>
      <a href="https://stathwang.github.io/tag/spatial-statistics.html">spatial statistics</a>
      <a href="https://stathwang.github.io/tag/r.html">r</a>
    </p>
  </div>
<div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'thedatalogical';
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
</article>

    <hr />
    <p />
    <!-- Begin MailChimp Signup Form -->
<link href="//cdn-images.mailchimp.com/embedcode/horizontal-slim-10_7.css" rel="stylesheet" type="text/css">
<style type="text/css">
  #mc_embed_signup{background:#fff; clear:left; font:14px Helvetica,Arial,sans-serif; width:100%;}
  /* Add your own MailChimp form style overrides in your site stylesheet or in this style block.
     We recommend moving this block and the preceding CSS link to the HEAD of your HTML file. */
</style>
<div id="mc_embed_signup">
<form action="//github.us1.list-manage.com/subscribe/post?u=0f2c943c221c777ef88591fb6&amp;id=6cf4236c90" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate>
    <div id="mc_embed_signup_scroll">
  <label for="mce-EMAIL">Subscribe to my sporadic data science newsletter and blog post</label>
  <input type="email" value="" name="EMAIL" class="email" id="mce-EMAIL" placeholder="email address" required>
    <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups-->
    <div style="position: absolute; left: -5000px;" aria-hidden="true"><input type="text" name="b_0f2c943c221c777ef88591fb6_6cf4236c90" tabindex="-1" value=""></div>
    <div class="clear"><input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" class="button"></div>
    </div>
</form>
</div>
<br />
<br />

<!--End mc_embed_signup-->

    <footer>
<p>
  &copy; Seong Hyun Hwang 2015 - 2017 - This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>
</p>
<p>
  <a rel="license"
     href="http://creativecommons.org/licenses/by-sa/4.0/"
     target="_blank">
    <img alt="Creative Commons License"
         title="Creative Commons License"
         style="border-width:0"
         src="https://i.creativecommons.org/l/by-sa/4.0/80x15.png"
         width="80"
         height="15"/>
  </a>
</p>    </footer>
  </main>

<!-- Google Analytics -->
<script type="text/javascript">
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-69797568-1', 'auto');
  ga('send', 'pageview');
</script>
<!-- End Google Analytics -->
  <script type="text/javascript" src="//s3.amazonaws.com/downloads.mailchimp.com/js/signup-forms/popup/embed.js" data-dojo-config="usePlainJson: true, isDebug: false"></script><script type="text/javascript">require(["mojo/signup-forms/Loader"], function(L) { L.start({"baseUrl":"mc.us1.list-manage.com","uuid":"0f2c943c221c777ef88591fb6","lid":"6cf4236c90"}) })</script>



<!-- Piwik -->
<script type="text/javascript">
  var _paq = _paq || [];
  _paq.push(['trackPageView']);
  _paq.push(['enableLinkTracking']);
  (function() {
    var u="//" + stathwang.piwikpro.com + "/";
    _paq.push(['setTrackerUrl', u+'piwik.php']);
    _paq.push(['setSiteId', 1]);
    var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
    g.type='text/javascript'; g.async=true; g.defer=true; g.src=u+'piwik.js'; s.parentNode.insertBefore(g,s);
  })();
</script>
<noscript><p><img src="//bnjbvr.alwaysdata.net/piwik/piwik.php?idsite=1" style="border:0;" alt="" /></p></noscript>
<!-- End Piwik Code -->
<script type="application/ld+json">
{
  "@context" : "http://schema.org",
  "@type" : "Blog",
  "name": " Seong Hyun Hwang ",
  "url" : "https://stathwang.github.io",
  "image": "http://www.gravatar.com/avatar/ea0e94239070aef9781e64fb53facf13?s=120&d=http%3A%2F%2Fwww.example.com%2Fdefault.jpg",
  "description": "Seong Hyun Hwang's Thoughts and Writings"
}
</script>
<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "BlogPosting",
  "name": "Predicting Free Public WiFi Locations in Seoul with Point Process Models using Foursquare API",
  "headline": "Predicting Free Public WiFi Locations in Seoul with Point Process Models using Foursquare API",
  "datePublished": "2017-06-25 01:45:00-04:00",
  "dateModified": "",
  "author": {
    "@type": "Person",
    "name": "Seong Hyun Hwang",
    "url": "https://stathwang.github.io/author/seong-hyun-hwang.html"
  },
  "image": "http://www.gravatar.com/avatar/ea0e94239070aef9781e64fb53facf13?s=120&d=http%3A%2F%2Fwww.example.com%2Fdefault.jpg",
  "url": "https://stathwang.github.io/predicting-free-public-wifi-locations-in-seoul-with-point-process-models-using-foursquare-api.html",
  "description": "Introduction The field of spatial statistics is experiencing a period of rapid growth, though less so compared to that of machine learning and artificial intelligence, with the onset of location technology and efficient solution techniques for high performance computing, which has begun to replace classical frequentist inference procedures developed years …"
}
</script></body>
</html>