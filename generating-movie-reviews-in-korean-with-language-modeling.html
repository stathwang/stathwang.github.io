<!DOCTYPE html>
<html lang="en">
<head>
  <link href='//fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,700,400italic' rel='stylesheet' type='text/css'>

    <link rel="stylesheet" type="text/css" href="https://stathwang.github.io/theme/stylesheet/style.min.css">

  <link rel="stylesheet" type="text/css" href="https://stathwang.github.io/theme/pygments/monokai.min.css">
  <link rel="stylesheet" type="text/css" href="https://stathwang.github.io/theme/font-awesome/css/font-awesome.min.css">


    <link href="https://stathwang.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Seong Hyun Hwang Atom">



  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="robots" content="" />

    <!-- Chrome, Firefox OS and Opera -->
    <meta name="theme-color" content="#333333">
    <!-- Windows Phone -->
    <meta name="msapplication-navbutton-color" content="#333333">
    <!-- iOS Safari -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

<meta name="author" content="Seong Hyun Hwang" />
<meta name="description" content="A statistical language modeling is a task of computing the probability of a sentence or sequence of words from a corpus. The standard is a trigram language model where the probability of a next word depends only on the previous two words. But the state-of-the-art as of writing is achieved …" />
<meta name="keywords" content="language modeling, markov chain, natural language processing, python">
<meta property="og:site_name" content="Seong Hyun Hwang"/>
<meta property="og:title" content="Generating Movie Reviews in Korean with Language Modeling"/>
<meta property="og:description" content="A statistical language modeling is a task of computing the probability of a sentence or sequence of words from a corpus. The standard is a trigram language model where the probability of a next word depends only on the previous two words. But the state-of-the-art as of writing is achieved …"/>
<meta property="og:locale" content="en_US"/>
<meta property="og:url" content="https://stathwang.github.io/generating-movie-reviews-in-korean-with-language-modeling.html"/>
<meta property="og:type" content="article"/>
<meta property="article:published_time" content="2017-03-23 13:45:00-04:00"/>
<meta property="article:modified_time" content=""/>
<meta property="article:author" content="https://stathwang.github.io/author/seong-hyun-hwang.html">
<meta property="article:section" content="Machine Learning"/>
<meta property="article:tag" content="language modeling"/>
<meta property="article:tag" content="markov chain"/>
<meta property="article:tag" content="natural language processing"/>
<meta property="article:tag" content="python"/>
<meta property="og:image" content="http://www.gravatar.com/avatar/ea0e94239070aef9781e64fb53facf13?s=120&d=http%3A%2F%2Fwww.example.com%2Fdefault.jpg">
  <title>Seong Hyun Hwang &ndash; Generating Movie Reviews in Korean with Language Modeling</title>
</head>
<body>
  <aside>
    <div>
      <a href="https://stathwang.github.io">
        <img src="http://www.gravatar.com/avatar/ea0e94239070aef9781e64fb53facf13?s=120&d=http%3A%2F%2Fwww.example.com%2Fdefault.jpg" alt="Seong Hyun Hwang" title="Seong Hyun Hwang">
      </a>
      <h1><a href="https://stathwang.github.io">Seong Hyun Hwang</a></h1>
<p>Data Scientist - Product Developer</p>      <nav>
        <ul class="list">
          <li><a href="https://stathwang.github.io/pages/about.html#about">about</a></li>
          <li><a href="https://stathwang.github.io/pages/photos.html#photos">photos</a></li>
          <li><a href="https://stathwang.github.io/pages/projects.html#projects">projects</a></li>
        </ul>
      </nav>
      <ul class="social">
        <li><a class="sc-linkedin" href="https://www.linkedin.com/in/seonghyunhwang" target="_blank"><i class="fa fa-linkedin"></i></a></li>
        <li><a class="sc-github" href="https://github.com/stathwang" target="_blank"><i class="fa fa-github"></i></a></li>
        <li><a class="sc-google" href="https://plus.google.com/112356517445062778569" target="_blank"><i class="fa fa-google"></i></a></li>
        <li><a class="sc-twitter" href="https://twitter.com/superhugehwang" target="_blank"><i class="fa fa-twitter"></i></a></li>
        <li><a class="sc-rss" href="//stathwang.github.io/feeds/all.atom.xml" target="_blank"><i class="fa fa-rss"></i></a></li>
      </ul>
    </div>
  </aside>
  <main>
    <nav>
      <a href="https://stathwang.github.io">Home</a>
      <a href="/archives.html">Archives</a>
      <a href="/categories.html">Categories</a>
      <a href="/tags.html">Tags</a>
      <a href="https://stathwang.github.io/feeds/all.atom.xml">Atom</a>
    </nav>

<article>
  <header>
    <h1 id="generating-movie-reviews-in-korean-with-language-modeling">Generating Movie Reviews in Korean with Language Modeling</h1>
    <p>Posted on March 23 2017 in <a href="https://stathwang.github.io/category/machine-learning.html">Machine Learning</a></p>
  </header>
  <div>
    <p>A statistical language modeling is a task of computing the probability of a sentence or sequence of words from a corpus. The standard is a trigram language model where the probability of a next word depends only on the previous two words. But the state-of-the-art as of writing is achieved by using neural networks such as <code>RNN</code> and <code>LSTM</code> and using variants of probabilistic context-free grammars to produce grammatically sound sentences. I'll write about deep learning methods later when I have more free time, so stay tuned. In this post, I write a set of Python scripts to build unigram, bigram, trigram, and linearly interpolated language models using the <code>ratings.txt</code> <a href="https://github.com/e9t/nsmc">dataset</a> that contains movie reviews in Korean scraped from <a href="http://movie.naver.com/movie/point/af/list.nhn">Naver Movies</a> dataset in order to randomly generated movie reviews.</p>
<ul>
<li>
<p><code>tokenize_tag()</code> tokenizes each sentence in a corpus and tags it with an appropriate part-of-speech according to the set of grammatical rules in Korean language with the help of <code>konlpy</code> module.</p>
</li>
<li>
<p><code>calc_ngram</code> calculates ngrams for each sentence without using <code>nltk</code> module.</p>
</li>
<li>
<p><code>calc_probabilities()</code> calculates unigram, bigram, and trigram probabilities given a training corpus, which is a list of sentences where each sentence is a string with tokens separates by spaces, ending in a newline character. This function outputs three python dictionaries where the keys are tuples expressing the ngram and the value is the log probability of that ngram.</p>
</li>
<li>
<p><code>q1_output()</code> writes unigram, bigram, trigrams, and their respective log probabilities to a text file.</p>
</li>
<li>
<p><code>score()</code> assigns a probability to each training sentence based on ngrams and their probabilities.</p>
</li>
<li>
<p><code>score_output()</code> writes sentence probabilities to a text file.</p>
</li>
<li>
<p><code>linearscore()</code> assigns a probability to each training sentence based on a linear interpolation among ngrams with <span class="math">\(\lambda\)</span> fixed to <span class="math">\(1/3\)</span>, but the optimal value of <span class="math">\(\lambda\)</span> can be found using a cross-validation.</p>
</li>
</ul>
<div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/python3</span>
<span class="c1"># -*- coding: utf-8 -*-</span>

<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">defaultdict</span>
<span class="kn">from</span> <span class="nn">konlpy.tag</span> <span class="kn">import</span> <span class="n">Twitter</span>

<span class="n">START_SYMBOL</span> <span class="o">=</span> <span class="s1">&#39;*&#39;</span>
<span class="n">STOP_SYMBOL</span> <span class="o">=</span> <span class="s1">&#39;STOP&#39;</span>
<span class="n">MINUS_INFINITY_SENTENCE_LOG_PROB</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1000</span>

<span class="k">def</span> <span class="nf">read_data</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">corpus</span> <span class="o">=</span> <span class="p">[</span><span class="n">row</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">splitlines</span><span class="p">()]</span>
        <span class="n">corpus</span> <span class="o">=</span> <span class="n">corpus</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
    <span class="k">return</span> <span class="n">corpus</span>

<span class="k">def</span> <span class="nf">tokenize_tag</span><span class="p">(</span><span class="n">corpus</span><span class="p">):</span>
    <span class="n">pos_tagger</span> <span class="o">=</span> <span class="n">Twitter</span><span class="p">()</span>
    <span class="k">return</span> <span class="p">[</span><span class="s1">&#39;/&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">pos_tagger</span><span class="o">.</span><span class="n">pos</span><span class="p">(</span><span class="n">corpus</span><span class="p">)]</span>

<span class="k">def</span> <span class="nf">calc_ngram</span><span class="p">(</span><span class="n">sentence</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
    <span class="n">tokens</span> <span class="o">=</span> <span class="p">[</span><span class="n">START_SYMBOL</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">sentence</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()</span> <span class="o">+</span> <span class="p">[</span><span class="n">STOP_SYMBOL</span><span class="p">]</span>
    <span class="n">ngrams</span> <span class="o">=</span> <span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="n">tokens</span><span class="p">[</span><span class="n">i</span><span class="p">:(</span><span class="n">i</span><span class="o">+</span><span class="n">n</span><span class="p">)])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">tokens</span><span class="p">)</span><span class="o">-</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)]</span>
    <span class="k">return</span> <span class="n">ngrams</span>

<span class="k">def</span> <span class="nf">calc_probabilities</span><span class="p">(</span><span class="n">training_corpus</span><span class="p">):</span>
    <span class="n">unigram_c</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
    <span class="n">bigram_c</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
    <span class="n">trigram_c</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">sent</span> <span class="ow">in</span> <span class="n">training_corpus</span><span class="p">:</span>
        <span class="n">tokens_u</span> <span class="o">=</span> <span class="n">calc_ngram</span><span class="p">(</span><span class="n">sent</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">tokens_b</span> <span class="o">=</span> <span class="n">calc_ngram</span><span class="p">(</span><span class="n">sent</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">tokens_t</span> <span class="o">=</span> <span class="n">calc_ngram</span><span class="p">(</span><span class="n">sent</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">unigram</span> <span class="ow">in</span> <span class="n">tokens_u</span><span class="p">:</span>
            <span class="n">unigram_c</span><span class="p">[</span><span class="n">unigram</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="k">for</span> <span class="n">bigram</span> <span class="ow">in</span> <span class="n">tokens_b</span><span class="p">:</span>
            <span class="n">bigram_c</span><span class="p">[</span><span class="n">bigram</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="k">for</span> <span class="n">trigram</span> <span class="ow">in</span> <span class="n">tokens_t</span><span class="p">:</span>
            <span class="n">trigram_c</span><span class="p">[</span><span class="n">trigram</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="n">unigram_total</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">unigram_c</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
    <span class="n">unigram_p</span> <span class="o">=</span> <span class="p">{</span><span class="n">a</span><span class="p">:</span> <span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">unigram_c</span><span class="p">[</span><span class="n">a</span><span class="p">],</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">unigram_total</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">unigram_c</span><span class="p">}</span>

    <span class="n">unigram_c</span><span class="p">[</span><span class="n">START_SYMBOL</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">training_corpus</span><span class="p">)</span>
    <span class="n">bigram_p</span> <span class="o">=</span> <span class="p">{(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span> <span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">bigram_c</span><span class="p">[(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)],</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">unigram_c</span><span class="p">[(</span><span class="n">a</span><span class="p">,)],</span> <span class="mi">2</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">bigram_c</span><span class="p">}</span>

    <span class="n">bigram_c</span><span class="p">[(</span><span class="n">START_SYMBOL</span><span class="p">,</span> <span class="n">START_SYMBOL</span><span class="p">)]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">training_corpus</span><span class="p">)</span>
    <span class="n">trigram_p</span> <span class="o">=</span> <span class="p">{(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span> <span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">trigram_c</span><span class="p">[(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">)],</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">bigram_c</span><span class="p">[(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)],</span> <span class="mi">2</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">trigram_c</span><span class="p">}</span>

    <span class="k">return</span> <span class="n">unigram_p</span><span class="p">,</span> <span class="n">bigram_p</span><span class="p">,</span> <span class="n">trigram_p</span>

<span class="k">def</span> <span class="nf">q1_output</span><span class="p">(</span><span class="n">unigrams</span><span class="p">,</span> <span class="n">bigrams</span><span class="p">,</span> <span class="n">trigrams</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
    <span class="n">outfile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>

    <span class="n">unigrams_keys</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">unigrams</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
    <span class="n">unigrams_keys</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">unigram</span> <span class="ow">in</span> <span class="n">unigrams_keys</span><span class="p">:</span>
        <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;UNIGRAM &#39;</span> <span class="o">+</span> <span class="n">unigram</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">unigrams</span><span class="p">[</span><span class="n">unigram</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="n">bigrams_keys</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">bigrams</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
    <span class="n">bigrams_keys</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">bigram</span> <span class="ow">in</span> <span class="n">bigrams_keys</span><span class="p">:</span>
        <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;BIGRAM &#39;</span> <span class="o">+</span> <span class="n">bigram</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="n">bigram</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">bigrams</span><span class="p">[</span><span class="n">bigram</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="n">trigrams_keys</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">trigrams</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
    <span class="n">trigrams_keys</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">trigram</span> <span class="ow">in</span> <span class="n">trigrams_keys</span><span class="p">:</span>
        <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;TRIGRAM &#39;</span> <span class="o">+</span> <span class="n">trigram</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="n">trigram</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="n">trigram</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">trigrams</span><span class="p">[</span><span class="n">trigram</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="n">outfile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">score</span><span class="p">(</span><span class="n">ngram_p</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">corpus</span><span class="p">):</span>
    <span class="n">scores</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">sent</span> <span class="ow">in</span> <span class="n">corpus</span><span class="p">:</span>
        <span class="n">ngrams</span> <span class="o">=</span> <span class="n">calc_ngram</span><span class="p">(</span><span class="n">sent</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
        <span class="n">prob_sent</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="n">ngram</span> <span class="ow">in</span> <span class="n">ngram_p</span> <span class="k">for</span> <span class="n">ngram</span> <span class="ow">in</span> <span class="n">ngrams</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">ngram</span> <span class="ow">in</span> <span class="n">ngrams</span><span class="p">:</span>
                <span class="n">prob_sent</span> <span class="o">+=</span> <span class="n">ngram_p</span><span class="p">[</span><span class="n">ngram</span><span class="p">]</span>
            <span class="n">scores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">prob_sent</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">scores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">MINUS_INFINITY_SENTENCE_LOG_PROB</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">scores</span>

<span class="k">def</span> <span class="nf">score_output</span><span class="p">(</span><span class="n">scores</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
    <span class="n">outfile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">score</span> <span class="ow">in</span> <span class="n">scores</span><span class="p">:</span>
        <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">score</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">outfile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">linearscore</span><span class="p">(</span><span class="n">unigrams</span><span class="p">,</span> <span class="n">bigrams</span><span class="p">,</span> <span class="n">trigrams</span><span class="p">,</span> <span class="n">corpus</span><span class="p">):</span>
    <span class="n">scores</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">global_lambda</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="mi">3</span>
    <span class="k">for</span> <span class="n">sent</span> <span class="ow">in</span> <span class="n">corpus</span><span class="p">:</span>
        <span class="n">ngrams</span> <span class="o">=</span> <span class="n">calc_ngram</span><span class="p">(</span><span class="n">sent</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
        <span class="n">lin_interpolated_score</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">trigram</span> <span class="ow">in</span> <span class="n">ngrams</span><span class="p">:</span>
            <span class="n">p3</span> <span class="o">=</span> <span class="n">trigrams</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">trigram</span><span class="p">,</span> <span class="n">MINUS_INFINITY_SENTENCE_LOG_PROB</span><span class="p">)</span>
            <span class="n">p2</span> <span class="o">=</span> <span class="n">bigrams</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">trigram</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">],</span> <span class="n">MINUS_INFINITY_SENTENCE_LOG_PROB</span><span class="p">)</span>
            <span class="n">p1</span> <span class="o">=</span> <span class="n">unigrams</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">trigram</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">MINUS_INFINITY_SENTENCE_LOG_PROB</span><span class="p">)</span>
            <span class="n">lin_interpolated_score</span> <span class="o">+=</span> <span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">global_lambda</span> <span class="o">*</span> <span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="n">p3</span> <span class="o">+</span> <span class="mi">2</span><span class="o">**</span><span class="n">p2</span> <span class="o">+</span> <span class="mi">2</span><span class="o">**</span><span class="n">p1</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">scores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">lin_interpolated_score</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">scores</span>

<span class="n">DATA_PATH</span> <span class="o">=</span> <span class="s1">&#39;PATH_TO_YOUR_DATA_FILES&#39;</span>
<span class="n">OUTPUT_PATH</span> <span class="o">=</span> <span class="s1">&#39;PATH_TO_YOUR_OUTPUT&#39;</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">time</span><span class="o">.</span><span class="n">clock</span><span class="p">()</span>

    <span class="n">infile</span> <span class="o">=</span> <span class="n">DATA_PATH</span> <span class="o">+</span> <span class="s1">&#39;ratings.txt&#39;</span>
    <span class="n">train</span> <span class="o">=</span> <span class="n">read_data</span><span class="p">(</span><span class="n">infile</span><span class="p">)</span>
    <span class="n">doc</span> <span class="o">=</span> <span class="p">[</span><span class="n">tokenize_tag</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">train</span><span class="p">]</span>

    <span class="n">corpus</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">tag_token</span> <span class="ow">in</span> <span class="n">doc</span><span class="p">:</span>
        <span class="n">sent</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">elem</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">tag_token</span><span class="p">])</span>
        <span class="n">corpus</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sent</span><span class="p">)</span>

    <span class="n">outfile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">OUTPUT_PATH</span> <span class="o">+</span> <span class="s1">&#39;corpus.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">corpus</span><span class="p">:</span>
        <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">row</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">outfile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="n">unigrams</span><span class="p">,</span> <span class="n">bigrams</span><span class="p">,</span> <span class="n">trigrams</span> <span class="o">=</span> <span class="n">calc_probabilities</span><span class="p">(</span><span class="n">corpus</span><span class="p">)</span>

    <span class="n">q1_output</span><span class="p">(</span><span class="n">unigrams</span><span class="p">,</span> <span class="n">bigrams</span><span class="p">,</span> <span class="n">trigrams</span><span class="p">,</span> <span class="n">OUTPUT_PATH</span> <span class="o">+</span> <span class="s1">&#39;ngram_probs.txt&#39;</span><span class="p">)</span>

    <span class="n">uniscores</span> <span class="o">=</span> <span class="n">score</span><span class="p">(</span><span class="n">unigrams</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">corpus</span><span class="p">)</span>
    <span class="n">biscores</span> <span class="o">=</span> <span class="n">score</span><span class="p">(</span><span class="n">bigrams</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">corpus</span><span class="p">)</span>
    <span class="n">triscores</span> <span class="o">=</span> <span class="n">score</span><span class="p">(</span><span class="n">trigrams</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">corpus</span><span class="p">)</span>

    <span class="n">score_output</span><span class="p">(</span><span class="n">uniscores</span><span class="p">,</span> <span class="n">OUTPUT_PATH</span> <span class="o">+</span> <span class="s1">&#39;unigram_scores.txt&#39;</span><span class="p">)</span>
    <span class="n">score_output</span><span class="p">(</span><span class="n">biscores</span><span class="p">,</span> <span class="n">OUTPUT_PATH</span> <span class="o">+</span> <span class="s1">&#39;bigram_scores.txt&#39;</span><span class="p">)</span>
    <span class="n">score_output</span><span class="p">(</span><span class="n">triscores</span><span class="p">,</span> <span class="n">OUTPUT_PATH</span> <span class="o">+</span> <span class="s1">&#39;trigram_scores.txt&#39;</span><span class="p">)</span>

    <span class="n">linearscores</span> <span class="o">=</span> <span class="n">linearscore</span><span class="p">(</span><span class="n">unigrams</span><span class="p">,</span> <span class="n">bigrams</span><span class="p">,</span> <span class="n">trigrams</span><span class="p">,</span> <span class="n">corpus</span><span class="p">)</span>

    <span class="n">score_output</span><span class="p">(</span><span class="n">linearscores</span><span class="p">,</span> <span class="n">OUTPUT_PATH</span> <span class="o">+</span> <span class="s1">&#39;linear_scores.txt&#39;</span><span class="p">)</span>

    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Time: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">clock</span><span class="p">())</span> <span class="o">+</span> <span class="s1">&#39; sec&#39;</span><span class="p">)</span>

<span class="k">if</span> <span class="vm">__name__</span><span class="o">==</span><span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>


<p>Once we have <code>unigram_scores.txt</code>, <code>bigram_scores.txt</code>, <code>trigram_scores.txt</code>, and <code>linear_scores.txt</code> files, we can compute their perplexities on <code>ratings.txt</code> using the Python script below. The resulting perplexities of different language models are shown:</p>
<ul>
<li>
<p>Unigram LM: <span class="math">\(1279.036\)</span></p>
</li>
<li>
<p>Bigram LM: <span class="math">\(52.768\)</span></p>
</li>
<li>
<p>Trigram LM: <span class="math">\(10.357\)</span></p>
</li>
<li>
<p>Linear Interpolation: <span class="math">\(15.068\)</span></p>
</li>
</ul>
<p>As we can see, the trigram language model does the best on the training set since it has the lowest perplexity. The linear interpolation model actually does worse than the trigram model because we are calculating the perplexity on the entire training set where trigrams are always seen. If we were to calculate the perplexity on the test set where new trigrams exist, then we'd expect to see lower score on the linear interpolation than on the trigram model.</p>
<div class="highlight"><pre><span></span><span class="c1"># an example usage</span>
<span class="n">python3</span> <span class="n">perplexity</span><span class="o">.</span><span class="n">py</span> <span class="n">trigram_scores</span><span class="o">.</span><span class="n">txt</span> <span class="n">corpus</span><span class="o">.</span><span class="n">txt</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/python3</span>
<span class="c1"># -*- coding: utf-8 -*-</span>

<span class="kn">import</span> <span class="nn">sys</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Usage: python perplexity.py &lt;file of scores&gt; &lt;file of sentences that were scored&gt;&#39;</span><span class="p">)</span>
        <span class="nb">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">infile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
    <span class="n">scores</span> <span class="o">=</span> <span class="n">infile</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
    <span class="n">infile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="n">infile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
    <span class="n">sentences</span> <span class="o">=</span> <span class="n">infile</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
    <span class="n">infile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="n">M</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">for</span> <span class="n">sentence</span> <span class="ow">in</span> <span class="n">sentences</span><span class="p">:</span>
        <span class="n">words</span> <span class="o">=</span> <span class="n">sentence</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
        <span class="n">M</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">words</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>

    <span class="n">perplexity</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">score</span> <span class="ow">in</span> <span class="n">scores</span><span class="p">:</span>
        <span class="n">perplexity</span> <span class="o">+=</span> <span class="nb">float</span><span class="p">(</span><span class="n">score</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span> <span class="c1"># assume log probability</span>

    <span class="n">perplexity</span> <span class="o">/=</span> <span class="n">M</span>
    <span class="n">perplexity</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">**</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">perplexity</span><span class="p">)</span>

    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;The perplexity is&#39;</span><span class="p">,</span> <span class="n">perplexity</span><span class="p">)</span>

<span class="k">if</span> <span class="vm">__name__</span><span class="o">==</span><span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>


<p>Now, I'm going to randomly generate sentences based on the trigram language model. The following Python script outputs 20 randomly generated movie reviews.</p>
<ul>
<li>
<p><code>partial_match()</code> outputs all key-value pairs in the trigram model dictionary that have the same first two elements of an input key.</p>
</li>
<li>
<p><code>weighted_pick()</code> picks the next word in a sequence of words from a conditional probability distribution.</p>
</li>
<li>
<p><code>generate_sentence()</code> randomly creates a sentence.</p>
</li>
</ul>
<div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/python3</span>
<span class="c1"># -*- coding: utf-8 -*-</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">defaultdict</span>

<span class="n">START_SYMBOL</span> <span class="o">=</span> <span class="s1">&#39;*&#39;</span>
<span class="n">STOP_SYMBOL</span> <span class="o">=</span> <span class="s1">&#39;STOP&#39;</span>

<span class="k">def</span> <span class="nf">partial_match</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">ngram_dict</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">ngram_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="n">k1</span> <span class="o">==</span> <span class="n">k2</span> <span class="ow">or</span> <span class="n">k2</span> <span class="ow">is</span> <span class="bp">None</span> <span class="k">for</span> <span class="n">k1</span><span class="p">,</span> <span class="n">k2</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">key</span><span class="p">)):</span>
            <span class="k">yield</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span>

<span class="k">def</span> <span class="nf">weighted_pick</span><span class="p">(</span><span class="n">words</span><span class="p">,</span> <span class="n">ngram_dict</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
    <span class="n">partial_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">partial_match</span><span class="p">(</span><span class="n">words</span><span class="p">,</span> <span class="n">ngram_dict</span><span class="p">))</span>
    <span class="n">next_words</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">probs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">items</span> <span class="o">=</span> <span class="n">partial_dict</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">trigram</span><span class="p">,</span> <span class="n">log_prob</span> <span class="ow">in</span> <span class="n">items</span><span class="p">:</span>
        <span class="n">next_words</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">trigram</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">probs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">2</span> <span class="o">**</span> <span class="nb">float</span><span class="p">(</span><span class="n">log_prob</span><span class="p">))</span>
    <span class="n">norm_probs</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span> <span class="o">/</span> <span class="nb">sum</span><span class="p">(</span><span class="n">probs</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">probs</span><span class="p">]</span>
    <span class="n">key</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">next_words</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">norm_probs</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">key</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

<span class="k">def</span> <span class="nf">generate_sentence</span><span class="p">(</span><span class="n">ngram_dict</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
    <span class="n">sentence</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">words</span> <span class="o">=</span> <span class="p">[</span><span class="n">START_SYMBOL</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="p">[</span><span class="bp">None</span><span class="p">]</span>

    <span class="n">word</span> <span class="o">=</span> <span class="n">weighted_pick</span><span class="p">(</span><span class="n">words</span><span class="p">,</span> <span class="n">ngram_dict</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
    <span class="k">while</span> <span class="n">word</span> <span class="o">!=</span> <span class="n">STOP_SYMBOL</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">n</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">del</span> <span class="n">words</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">del</span> <span class="n">words</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">words</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">word</span><span class="p">)</span>
            <span class="n">words</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">None</span><span class="p">)</span>
        <span class="n">sentence</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">word</span><span class="p">)</span>
        <span class="n">word</span> <span class="o">=</span> <span class="n">weighted_pick</span><span class="p">(</span><span class="n">words</span><span class="p">,</span> <span class="n">ngram_dict</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>

    <span class="k">print</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">sentence</span><span class="p">))</span>

<span class="n">OUTPUT_PATH</span> <span class="o">=</span> <span class="s1">&#39;/Users/seonghwang/SLMoutput/&#39;</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">OUTPUT_PATH</span> <span class="o">+</span> <span class="s1">&#39;ngram_probs.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">ngrams</span> <span class="o">=</span> <span class="p">[</span><span class="n">row</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">splitlines</span><span class="p">()]</span>
        <span class="n">trigram_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">ngrams</span> <span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;TRIGRAM&#39;</span><span class="p">]</span>
        <span class="n">trigram_dict</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">,</span> <span class="n">a3</span><span class="p">,</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">trigram_list</span><span class="p">:</span>
            <span class="n">trigram_dict</span><span class="p">[(</span><span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">,</span> <span class="n">a3</span><span class="p">)]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>

    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Generating random sentences...&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">):</span>
        <span class="n">generate_sentence</span><span class="p">(</span><span class="n">trigram_dict</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>

<span class="k">if</span> <span class="vm">__name__</span><span class="o">==</span><span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>


<p>Few interesting sentences that got generated:</p>
<ul>
<li>진짜 엄청 신선하고 몰입도 있고 재밌었 어요 ~ </li>
<li>이민정 정말 이쁘 고 스토리 전개도 억지 스럽 다고 생각하는 데 이번 역 은 안 봐 지 하고 개속 봣 는 데 .. 5 ~ 7 점 이 아깝 다 </li>
<li>여친 따라 봤 다 후회 없 음 </li>
<li>ㄷㄷㄷ 담배 만 피우다 끝나는 영화 . 다 들 연기 안습 ㅡㅡ 스토리 가 주 운송 수단 이라는 점 에서 그 이상 의 디테 일도 쉣 ... 디테 일도 좋 았 어요 . 이 드라마 한가지 만 집중 적 으로 성동일 팬 이라 봤 지만 역시 재미있네 요 </li>
<li>잔잔 하니 감동 도 없는 영화 </li>
<li>영화 끝나고 스트레스 받았 다 는 것 ... </li>
<li>어쩔 수 없이 1 점 이다 . </li>
</ul>
<p>Other movie reviews that seem grammatically incorrect or sarcastic:</p>
<ul>
<li>미국 판 두 개 는 과거 들 과거 속 으로 들어가서 머리카락 이 영수증 분쇄기 에 찡 함</li>
<li>이 것 이 아 무 생각 없이 볼 만 했 던 신의 ... 지금 도 가슴 설레는 영화 ost 앨범 도 구매 해서 봤 다 . </li>
<li>한 남자 를 돌려 애써 모면 하려 하 는데 내 가 느와르 를 원한 다 진짜 !!!"""" 처음 엔 재밌게 만 봤 는데도 눈시울 붉 혔 네 요 ... 어디 유쾌 한 공정 드라마 . 로튼 토마토 가 모든 것 들 은 멋진 훈남 훈녀 다 .</li>
<li>1 점 드립니 다 . 최고 ! </li>
<li>잔잔 한 감동 을 주는 공포영화 는 절대 영화관 가서 봣다 가 S 급 </li>
<li>현재 tv 시트콤 수준 이 1998 년 당시 에는 파격 적 인 제목 은 기술자 들 이야 말로 다른 배트맨 시리즈 를 다시 찍어 봐 . 38 분 까지 역겨운 짓 하던 니 들 이 이 것 보단 재밌겠 다 능 </li>
</ul>
<p>Most short sentences that got generated seemed okay, while long sentences or sentences with movie names in them sounded a bit weird.</p>
<script type="text/javascript">if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var align = "center",
        indent = "0em",
        linebreak = "false";

    if (false) {
        align = (screen.width < 768) ? "left" : align;
        indent = (screen.width < 768) ? "0em" : indent;
        linebreak = (screen.width < 768) ? 'true' : linebreak;
    }

    var mathjaxscript = document.createElement('script');
    var location_protocol = (false) ? 'https' : document.location.protocol;
    if (location_protocol !== 'http' && location_protocol !== 'https') location_protocol = 'https:';
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = location_protocol + '//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: '"+ align +"'," +
        "    displayIndent: '"+ indent +"'," +
        "    showMathMenu: true," +
        "    messageStyle: 'normal'," +
        "    tex2jax: { " +
        "        inlineMath: [ ['\\\\(','\\\\)'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'inherit ! important'} }," +
        "        linebreaks: { automatic: "+ linebreak +", width: '90% container' }," +
        "    }, " +
        "}); " +
        "if ('default' !== 'default') {" +
            "MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
            "MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
        "}";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
</script>
  </div>
  <div class="tag-cloud">
    <p>
      <a href="https://stathwang.github.io/tag/language-modeling.html">language modeling</a>
      <a href="https://stathwang.github.io/tag/markov-chain.html">markov chain</a>
      <a href="https://stathwang.github.io/tag/natural-language-processing.html">natural language processing</a>
      <a href="https://stathwang.github.io/tag/python.html">python</a>
    </p>
  </div>
<div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'thedatalogical';
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
</article>

    <hr />
    <p />
    <!-- Begin MailChimp Signup Form -->
<link href="//cdn-images.mailchimp.com/embedcode/horizontal-slim-10_7.css" rel="stylesheet" type="text/css">
<style type="text/css">
  #mc_embed_signup{background:#fff; clear:left; font:14px Helvetica,Arial,sans-serif; width:100%;}
  /* Add your own MailChimp form style overrides in your site stylesheet or in this style block.
     We recommend moving this block and the preceding CSS link to the HEAD of your HTML file. */
</style>
<div id="mc_embed_signup">
<form action="//github.us1.list-manage.com/subscribe/post?u=0f2c943c221c777ef88591fb6&amp;id=6cf4236c90" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate>
    <div id="mc_embed_signup_scroll">
  <label for="mce-EMAIL">Subscribe to my sporadic data science newsletter and blog post</label>
  <input type="email" value="" name="EMAIL" class="email" id="mce-EMAIL" placeholder="email address" required>
    <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups-->
    <div style="position: absolute; left: -5000px;" aria-hidden="true"><input type="text" name="b_0f2c943c221c777ef88591fb6_6cf4236c90" tabindex="-1" value=""></div>
    <div class="clear"><input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" class="button"></div>
    </div>
</form>
</div>
<br />
<br />

<!--End mc_embed_signup-->

    <footer>
<p>
  &copy; Seong Hyun Hwang 2015 - 2017 - This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>
</p>
<p>
  <a rel="license"
     href="http://creativecommons.org/licenses/by-sa/4.0/"
     target="_blank">
    <img alt="Creative Commons License"
         title="Creative Commons License"
         style="border-width:0"
         src="https://i.creativecommons.org/l/by-sa/4.0/80x15.png"
         width="80"
         height="15"/>
  </a>
</p>    </footer>
  </main>

<!-- Google Analytics -->
<script type="text/javascript">
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-69797568-1', 'auto');
  ga('send', 'pageview');
</script>
<!-- End Google Analytics -->
  <script type="text/javascript" src="//s3.amazonaws.com/downloads.mailchimp.com/js/signup-forms/popup/embed.js" data-dojo-config="usePlainJson: true, isDebug: false"></script><script type="text/javascript">require(["mojo/signup-forms/Loader"], function(L) { L.start({"baseUrl":"mc.us1.list-manage.com","uuid":"0f2c943c221c777ef88591fb6","lid":"6cf4236c90"}) })</script>




<script type="application/ld+json">
{
  "@context" : "http://schema.org",
  "@type" : "Blog",
  "name": " Seong Hyun Hwang ",
  "url" : "https://stathwang.github.io",
  "image": "http://www.gravatar.com/avatar/ea0e94239070aef9781e64fb53facf13?s=120&d=http%3A%2F%2Fwww.example.com%2Fdefault.jpg",
  "description": "Seong Hyun Hwang's Thoughts and Writings"
}
</script>
<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "BlogPosting",
  "name": "Generating Movie Reviews in Korean with Language Modeling",
  "headline": "Generating Movie Reviews in Korean with Language Modeling",
  "datePublished": "2017-03-23 13:45:00-04:00",
  "dateModified": "",
  "author": {
    "@type": "Person",
    "name": "Seong Hyun Hwang",
    "url": "https://stathwang.github.io/author/seong-hyun-hwang.html"
  },
  "image": "http://www.gravatar.com/avatar/ea0e94239070aef9781e64fb53facf13?s=120&d=http%3A%2F%2Fwww.example.com%2Fdefault.jpg",
  "url": "https://stathwang.github.io/generating-movie-reviews-in-korean-with-language-modeling.html",
  "description": "A statistical language modeling is a task of computing the probability of a sentence or sequence of words from a corpus. The standard is a trigram language model where the probability of a next word depends only on the previous two words. But the state-of-the-art as of writing is achieved …"
}
</script></body>
</html>